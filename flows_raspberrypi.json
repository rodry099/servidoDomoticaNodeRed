[{"id":"d7ce74a.43e7388","type":"tab","label":"RiegoAuto","disabled":false,"info":"temporizar riego\n"},{"id":"f25737d2.a56978","type":"tab","label":"ControlRiego","disabled":false,"info":""},{"id":"d790f34d.d1733","type":"tab","label":"Home","disabled":false,"info":"pantalla principal con informacion \nde las actividades"},{"id":"c88d6057.281f6","type":"tab","label":"termostato","disabled":false,"info":""},{"id":"562c7a8f.cd8d24","type":"tab","label":"Registra Dispositivos","disabled":false,"info":""},{"id":"9735dbc5.e84748","type":"tab","label":"calefaccion","disabled":false,"info":""},{"id":"6749f74e.18d698","type":"tab","label":"RiegoManual","disabled":false,"info":""},{"id":"e1b7f5f3.0b6ab8","type":"ui_tab","z":"","name":"Riego","icon":"wi-wu-chancetstorms","order":2,"disabled":false,"hidden":false},{"id":"617de4b8.ce394c","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Control Domotico","hideToolbar":"false","allowSwipe":"true","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":28,"sy":28,"gx":17,"gy":17,"cx":6,"cy":6,"px":6,"py":6}}},{"id":"3e69dea1.d0ec72","type":"ui_spacer","name":"spacer","group":"","order":3,"width":1,"height":1},{"id":"2393d6f0.2f06da","type":"ui_spacer","name":"spacer","group":"b6d52961.196668","order":3,"width":"12","height":1},{"id":"75e02395.761c8c","type":"ui_spacer","name":"spacer","group":"b6d52961.196668","order":1,"width":"8","height":"1"},{"id":"6256ee51.4808","type":"ui_group","z":"","name":"Dias","tab":"e1b7f5f3.0b6ab8","order":2,"disp":true,"width":"8","collapse":false},{"id":"62f31826.772e28","type":"ui_spacer","name":"spacer","group":"6256ee51.4808","order":9,"width":"8","height":1},{"id":"e9229fb4.84a14","type":"ui_spacer","name":"spacer","group":"6256ee51.4808","order":1,"width":"8","height":1},{"id":"e6a57b48.64b4a8","type":"ui_group","z":"","name":"Tiempos","tab":"e1b7f5f3.0b6ab8","order":3,"disp":true,"width":"8","collapse":false},{"id":"89ba4b19.b941e8","type":"ui_group","z":"","name":"Acciones","tab":"e1b7f5f3.0b6ab8","order":4,"disp":true,"width":"8","collapse":false},{"id":"353193e2.3064fc","type":"mqtt-broker","z":"","name":"Brokker_domotica","broker":"192.168.0.166","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"b2c6e7a.a81ab18","type":"ui_spacer","name":"spacer","group":"89ba4b19.b941e8","order":2,"width":1,"height":1},{"id":"3afc7b88.263a54","type":"ui_group","z":"","name":"Horas","tab":"e1b7f5f3.0b6ab8","order":1,"disp":true,"width":"6","collapse":false},{"id":"16412209.8f2dee","type":"telegrambot-config","z":"","botname":"domobot","usernames":"","chatIds":"594372466","pollInterval":"300"},{"id":"1db130b2.f3c89f","type":"ui_tab","z":"","name":"Home","icon":"home","order":1,"disabled":false,"hidden":false},{"id":"c75bf9d7.1a78b8","type":"ui_spacer","name":"spacer","group":"","order":2,"width":"0","height":"0"},{"id":"c6a120a5.09b4f","type":"MySQLdatabase","z":"","host":"127.0.0.1","port":"3306","db":"devices","tz":""},{"id":"a7cf1fe4.c0ab9","type":"ui_group","z":"","name":"Dispositivos registrados","tab":"1db130b2.f3c89f","order":2,"disp":true,"width":"12","collapse":false},{"id":"1e9b1326.5b8a7d","type":"ui_group","z":"","name":"termostato","tab":"1db130b2.f3c89f","order":3,"disp":true,"width":"10","collapse":false},{"id":"690ae1c7.d6d05","type":"ui_spacer","name":"spacer","group":"1e9b1326.5b8a7d","order":12,"width":"10","height":1},{"id":"2ccfb2e6.8f96ae","type":"ui_spacer","name":"spacer","group":"1e9b1326.5b8a7d","order":16,"width":"10","height":1},{"id":"c564589c.16cf58","type":"ui_spacer","name":"spacer","group":"1e9b1326.5b8a7d","order":5,"width":"6","height":1},{"id":"131d7c1.ba0c584","type":"ui_spacer","name":"spacer","group":"1e9b1326.5b8a7d","order":9,"width":"5","height":"5"},{"id":"eb82bc63.c77d7","type":"ui_group","z":"","name":"RegistroNuevos","tab":"1db130b2.f3c89f","order":1,"disp":false,"width":"7","collapse":false},{"id":"7f7b5dc3.331514","type":"ui_group","z":"","name":"registra","tab":"e1b7f5f3.0b6ab8","disp":true,"width":"6","collapse":false},{"id":"f8c613ca.ef745","type":"ui_group","z":"","name":"Riego Manual","tab":"e1b7f5f3.0b6ab8","disp":true,"width":"8","collapse":false},{"id":"1eea9cb8.f74fe3","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Lunes","tooltip":"","group":"6256ee51.4808","order":2,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"lunes","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":390,"y":440,"wires":[["f6863d77.76ef8"]]},{"id":"17ee3fed.633ed","type":"ui_button","z":"d7ce74a.43e7388","name":"Guardar","group":"89ba4b19.b941e8","order":3,"width":0,"height":0,"passthru":false,"label":"Guardar","tooltip":"","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"guardar","x":660,"y":940,"wires":[["644d8d3.b6afa74"]]},{"id":"5987dbaa.0f3ac4","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Martes","tooltip":"","group":"6256ee51.4808","order":3,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"martes","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":500,"wires":[["ed8de645.11e578"]]},{"id":"a0f403d2.27998","type":"file","z":"d7ce74a.43e7388","name":"guardaRiego","filename":"resources/configuraciones/riego.json","appendNewline":false,"createDir":false,"overwriteFile":"true","x":1050,"y":940,"wires":[[]]},{"id":"ee0e806d.5c6d5","type":"function","z":"d7ce74a.43e7388","name":"lunes","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.lunes;\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":440,"wires":[["1eea9cb8.f74fe3","bb6fc4de.285108"]]},{"id":"e2f26495.f02f58","type":"file in","z":"d7ce74a.43e7388","name":"carga riego.json","filename":"resources/configuraciones/riego.json","format":"utf8","chunk":false,"sendError":false,"x":340,"y":280,"wires":[["2c038578.55e6da"]]},{"id":"b22fdd7c.b7677","type":"inject","z":"d7ce74a.43e7388","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":130,"y":280,"wires":[["e2f26495.f02f58"]]},{"id":"2c038578.55e6da","type":"json","z":"d7ce74a.43e7388","name":"configuracionRiego","property":"payload","action":"obj","pretty":false,"x":250,"y":340,"wires":[["546f443d.5da75c"]]},{"id":"a44b6b71.fcfc58","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Miercoles","tooltip":"","group":"6256ee51.4808","order":4,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"miercoles","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":560,"wires":[["967c4930.04b488"]]},{"id":"dc550438.e39a18","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Jueves","tooltip":"","group":"6256ee51.4808","order":5,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"jueves","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":620,"wires":[["6f93a289.07900c"]]},{"id":"3ed48153.b858fe","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Viernes","tooltip":"","group":"6256ee51.4808","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"viernes","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":680,"wires":[["855eeb6f.313308"]]},{"id":"3c017966.acb4f6","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Sabado","tooltip":"","group":"6256ee51.4808","order":7,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"sabado","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":740,"wires":[["4b692f8f.47a43"]]},{"id":"c3d283bb.11e12","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Domingo","tooltip":"","group":"6256ee51.4808","order":8,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"domingo","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":400,"y":800,"wires":[["e2947237.92f19"]]},{"id":"8a6b1431.824e08","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 1","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":"8","height":"1","passthru":true,"topic":"canal1","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":440,"wires":[["ea5a6f17.fa715"]]},{"id":"f38e97f5.a87ef8","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 2","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal2","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":500,"wires":[["da16374d.45da38"]]},{"id":"546f443d.5da75c","type":"change","z":"d7ce74a.43e7388","name":"","rules":[{"t":"set","p":"DatosRiego","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":340,"wires":[["ee0e806d.5c6d5","b98077d1.238b28","6de0598.b0c96a8","dd22aa7.7ceb058","9795264d.7f9c68"]]},{"id":"bb6fc4de.285108","type":"function","z":"d7ce74a.43e7388","name":"martes","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.martes;\nreturn msg;","outputs":1,"noerr":0,"x":220,"y":500,"wires":[["5987dbaa.0f3ac4","6e24fc71.8d7d84"]]},{"id":"6e24fc71.8d7d84","type":"function","z":"d7ce74a.43e7388","name":"miercoles","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.miercoles;\nreturn msg;","outputs":1,"noerr":0,"x":220,"y":560,"wires":[["a3287e55.6bf7a","a44b6b71.fcfc58"]]},{"id":"a3287e55.6bf7a","type":"function","z":"d7ce74a.43e7388","name":"jueves","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.jueves;\nreturn msg;","outputs":1,"noerr":0,"x":210,"y":620,"wires":[["dc550438.e39a18","a0f1a1cf.e4e4d"]]},{"id":"a0f1a1cf.e4e4d","type":"function","z":"d7ce74a.43e7388","name":"viernes","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.viernes;\nreturn msg;","outputs":1,"noerr":0,"x":220,"y":680,"wires":[["18a0c640.61eb2a","3ed48153.b858fe"]]},{"id":"18a0c640.61eb2a","type":"function","z":"d7ce74a.43e7388","name":"sabado","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.sabado;\nreturn msg;","outputs":1,"noerr":0,"x":218.01953125,"y":738.75390625,"wires":[["3c017966.acb4f6","bab3238f.a48ba"]]},{"id":"bab3238f.a48ba","type":"function","z":"d7ce74a.43e7388","name":"domingo","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.domingo;\nreturn msg;","outputs":1,"noerr":0,"x":220,"y":800,"wires":[["c3d283bb.11e12"]]},{"id":"b98077d1.238b28","type":"function","z":"d7ce74a.43e7388","name":"canal 1","func":"var testval = flow.get('DatosRiego');\nif(testval.canal1 === null){\nmsg.payload=2;}else msg.payload=testval.canal1;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":440,"wires":[["8a6b1431.824e08","11db53cb.524ecc"]]},{"id":"11db53cb.524ecc","type":"function","z":"d7ce74a.43e7388","name":"canal 2","func":"var testval = flow.get('DatosRiego');\nif(testval.canal2 === null){\nmsg.payload=2;}else msg.payload=testval.canal2;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":500,"wires":[["f38e97f5.a87ef8","253dbf1e.02ff"]]},{"id":"f6863d77.76ef8","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.lunes=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":440,"wires":[[]]},{"id":"ed8de645.11e578","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.martes=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":500,"wires":[[]]},{"id":"967c4930.04b488","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.miercoles=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":560,"wires":[[]]},{"id":"6f93a289.07900c","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.jueves=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":620,"wires":[[]]},{"id":"855eeb6f.313308","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.viernes=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":680,"wires":[[]]},{"id":"4b692f8f.47a43","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.sabado=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":527.01953125,"y":740.25390625,"wires":[[]]},{"id":"e2947237.92f19","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.domingo=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":530,"y":800,"wires":[[]]},{"id":"ea5a6f17.fa715","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.canal1=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":440,"wires":[[]]},{"id":"da16374d.45da38","type":"function","z":"d7ce74a.43e7388","name":"canal2","func":"var testval = flow.get('DatosRiego');\ntestval.canal2=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":500,"wires":[[]]},{"id":"644d8d3.b6afa74","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\nmsg.payload = testval;\nreturn msg;","outputs":1,"noerr":0,"x":830,"y":940,"wires":[["a0f403d2.27998"]]},{"id":"4659f630.a768a8","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 3","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal3","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":560,"wires":[["2547d01f.0a64d"]]},{"id":"dcb1549b.58b278","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 4","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal4","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":620,"wires":[["2253561f.f2607a"]]},{"id":"253dbf1e.02ff","type":"function","z":"d7ce74a.43e7388","name":"canal 3","func":"var testval = flow.get('DatosRiego');\nif(testval.canal3 === null){\nmsg.payload=2;}else msg.payload=testval.canal3;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":560,"wires":[["4659f630.a768a8","353d8caf.878cc4"]]},{"id":"353d8caf.878cc4","type":"function","z":"d7ce74a.43e7388","name":"canal 4","func":"var testval = flow.get('DatosRiego');\nif(testval.canal4 === null){\nmsg.payload=2;}else msg.payload=testval.canal4;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":620,"wires":[["dcb1549b.58b278","3db6af17.fd315"]]},{"id":"2547d01f.0a64d","type":"function","z":"d7ce74a.43e7388","name":"canal3","func":"var testval = flow.get('DatosRiego');\ntestval.canal3=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":560,"wires":[[]]},{"id":"2253561f.f2607a","type":"function","z":"d7ce74a.43e7388","name":"canal4","func":"var testval = flow.get('DatosRiego');\ntestval.canal4=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":620,"wires":[[]]},{"id":"658819b2.69c048","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 5","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal5","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":680,"wires":[["b634e42b.728008"]]},{"id":"15efd1e7.82a6ee","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 6","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal6","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":740,"wires":[["6dcd84a.c04797c"]]},{"id":"3db6af17.fd315","type":"function","z":"d7ce74a.43e7388","name":"canal 5","func":"var testval = flow.get('DatosRiego');\nif(testval.canal5 === null){\nmsg.payload=2;}else msg.payload=testval.canal5;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":680,"wires":[["658819b2.69c048","a7e2d28.720de3"]]},{"id":"a7e2d28.720de3","type":"function","z":"d7ce74a.43e7388","name":"canal 6","func":"var testval = flow.get('DatosRiego');\nif(testval.canal6 === null){\nmsg.payload=2;}else msg.payload=testval.canal6;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":740,"wires":[["15efd1e7.82a6ee","fd3b060f.b4c918"]]},{"id":"b634e42b.728008","type":"function","z":"d7ce74a.43e7388","name":"canal5","func":"var testval = flow.get('DatosRiego');\ntestval.canal5=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":680,"wires":[[]]},{"id":"6dcd84a.c04797c","type":"function","z":"d7ce74a.43e7388","name":"canal6","func":"var testval = flow.get('DatosRiego');\ntestval.canal6=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":740,"wires":[[]]},{"id":"50dce440.3fdc1c","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 7","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal7","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":800,"wires":[["bd9f690f.78a8b8"]]},{"id":"50220df9.ee39b4","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Valvula 8","tooltip":"","group":"e6a57b48.64b4a8","order":1,"width":0,"height":0,"passthru":true,"topic":"canal8","format":"{{value}}","min":0,"max":"99","step":1,"x":920,"y":860,"wires":[["b0e02ba2.d12c98"]]},{"id":"fd3b060f.b4c918","type":"function","z":"d7ce74a.43e7388","name":"canal 7","func":"var testval = flow.get('DatosRiego');\nif(testval.canal7 === null){\nmsg.payload=2;}else msg.payload=testval.canal7;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":800,"wires":[["50dce440.3fdc1c","433022ee.43b07c"]]},{"id":"433022ee.43b07c","type":"function","z":"d7ce74a.43e7388","name":"canal 8","func":"var testval = flow.get('DatosRiego');\nif(testval.canal8 === null){\nmsg.payload=2;}else msg.payload=testval.canal8;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":860,"wires":[["50220df9.ee39b4"]]},{"id":"bd9f690f.78a8b8","type":"function","z":"d7ce74a.43e7388","name":"canal7","func":"var testval = flow.get('DatosRiego');\ntestval.canal7=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":800,"wires":[[]]},{"id":"b0e02ba2.d12c98","type":"function","z":"d7ce74a.43e7388","name":"canal8","func":"var testval = flow.get('DatosRiego');\ntestval.canal8=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1050,"y":860,"wires":[[]]},{"id":"4ad17030.79b1d","type":"ui_switch","z":"d7ce74a.43e7388","name":"","label":"Estado On/Off","tooltip":"","group":"89ba4b19.b941e8","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"onOff","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":940,"y":340,"wires":[["c81c4611.fd5ca8"]]},{"id":"6de0598.b0c96a8","type":"function","z":"d7ce74a.43e7388","name":"Riego on off","func":"var testval = flow.get('DatosRiego');\nmsg.payload=testval.onOff;\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":340,"wires":[["4ad17030.79b1d"]]},{"id":"c81c4611.fd5ca8","type":"function","z":"d7ce74a.43e7388","name":"Estado","func":"var testval = flow.get('DatosRiego');\ntestval.onOff=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1120,"y":340,"wires":[[]]},{"id":"5881fa78.5e60a4","type":"inject","z":"f25737d2.a56978","name":"","topic":"","payload":"DatosRiegoLocal","payloadType":"flow","repeat":"5","crontab":"","once":true,"onceDelay":0.1,"x":140,"y":300,"wires":[["c31b6aa9.48f1e8"]]},{"id":"37d73dd0.a1d8c2","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Hora","tooltip":"","group":"3afc7b88.263a54","order":9,"width":0,"height":0,"passthru":true,"topic":"","format":"{{value}}","min":0,"max":"23","step":1,"x":890,"y":220,"wires":[["d15dee1c.815f8"]]},{"id":"3e07035a.0664fc","type":"ui_numeric","z":"d7ce74a.43e7388","name":"","label":"Minutos","tooltip":"","group":"3afc7b88.263a54","order":10,"width":0,"height":0,"passthru":true,"topic":"","format":"{{value}}","min":0,"max":"59","step":1,"x":880,"y":280,"wires":[["95c9373.68504c8"]]},{"id":"dd22aa7.7ceb058","type":"function","z":"d7ce74a.43e7388","name":"horas","func":"var testval = flow.get('DatosRiego');\nif(testval.horas === null){\nmsg.payload=0;}else msg.payload=testval.horas;\nreturn msg;","outputs":1,"noerr":0,"x":730,"y":220,"wires":[["f2ce1dd8.2e89a","37d73dd0.a1d8c2"]]},{"id":"f2ce1dd8.2e89a","type":"function","z":"d7ce74a.43e7388","name":"minutos","func":"var testval = flow.get('DatosRiego');\nif(testval.minutos === null){\nmsg.payload=0;}else msg.payload=testval.minutos;\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":280,"wires":[["3e07035a.0664fc"]]},{"id":"d15dee1c.815f8","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.horas=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1030,"y":220,"wires":[[]]},{"id":"95c9373.68504c8","type":"function","z":"d7ce74a.43e7388","name":"canal1","func":"var testval = flow.get('DatosRiego');\ntestval.minutos=msg.payload;\nreturn testval;","outputs":1,"noerr":0,"x":1010,"y":280,"wires":[[]]},{"id":"1752e121.9f253f","type":"function","z":"f25737d2.a56978","name":"comprueba dia semana","func":"var testval = flow.get('DatosRiegoLocal');\nvar horas = new Date();\n\nvar diaSemana = [testval.domingo,\n                 testval.lunes,\n                 testval.martes,\n                 testval.miercoles,\n                 testval.jueves,\n                 testval.viernes,\n                 testval.sabado];\nvar dia = horas.getDay();      \nvar diaActivo = diaSemana[dia];\n\nmsg.payload = diaActivo;\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":480,"wires":[["3535127c.4ea11e"]]},{"id":"3535127c.4ea11e","type":"switch","z":"f25737d2.a56978","name":"dia semana activo","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":540,"wires":[["8ea2adab.13cfe"],[]],"outputLabels":["dia programado",""]},{"id":"8ea2adab.13cfe","type":"function","z":"f25737d2.a56978","name":"comprueba hora","func":"var testval = flow.get('DatosRiegoLocal');\nvar funcionando = flow.get('Activo'); \nvar horas = new Date();\nvar hora = horas.getHours();\nvar minutos = horas.getMinutes();\nif(hora === testval.horas && minutos === testval.minutos){\n    \n    funcionando = true;\n    flow.set('Activo', funcionando);\n    msg.payload = true;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":600,"wires":[[]]},{"id":"22f020be.085b6","type":"switch","z":"f25737d2.a56978","name":"comprueba actividad","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":660,"y":420,"wires":[["1752e121.9f253f"],[]],"outputLabels":["activo",""]},{"id":"c608d316.1550b","type":"function","z":"f25737d2.a56978","name":"comprueba Activo","func":"var testval = flow.get('DatosRiegoLocal');\nvar onOff = testval.onOff;\nmsg.payload = onOff;\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":360,"wires":[["22f020be.085b6"]]},{"id":"390179be.3454d6","type":"switch","z":"f25737d2.a56978","name":"flag para riego activo","property":"Activo","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":true,"outputs":2,"x":640,"y":300,"wires":[["b8dfea6d.0e16d8","54b3894c.144348"],["c608d316.1550b"]]},{"id":"d75a4884.abb418","type":"function","z":"f25737d2.a56978","name":"crea Json","func":"var valores = {\n  \"canal\" : \"2\",\n  \"status\" : \"off\",\n  \"final\" : \"no\"\n};\nvalores.canal = msg.canal\nvalores.status = msg.estado;\nvalores.final = msg.final;\nmsg.payload = valores\nreturn msg;","outputs":1,"noerr":0,"x":920,"y":360,"wires":[["c16262d.d5baaa"]]},{"id":"b8dfea6d.0e16d8","type":"function","z":"f25737d2.a56978","name":"calcula tiempos","func":"var canales = flow.get('DatosRiegoLocal');\nvar funcionando = flow.get('Activo') || true;\nvar tiempohora = context.get('Tiempohora') || 0;\nvar tiempomin = context.get('Tiempomin') || 0;\nvar regando = flow.get('Regando') || false;\nvar indice = context.get('Indice') || 0;\nvar reloj = new Date();\nvar resto = 0;\nvar matriz = [canales.canal1,\n              canales.canal2,\n              canales.canal3,\n              canales.canal4,\n              canales.canal5,\n              canales.canal6,\n              canales.canal7,\n              canales.canal8\n              ];\n              \n    if(indice == 8){\n        funcionando = false;\n        indice = 0;\n        context.set('Indice', indice);\n        flow.set('Activo', funcionando);\n        msg.final = \"finalizado\";\n        return msg;\n    }\n              \n\n    if(matriz[indice] > 0 && regando === false){\n        \n       \n        tiempomin = reloj.getMinutes();\n        \n        if((tiempomin + matriz[indice]) > 59){\n            tiempomin = tiempomin+matriz[indice]-60;\n            resto = 1;\n        }else{\n            \n            tiempomin = tiempomin+matriz[indice];\n            resto = 0;\n        }\n        \n         tiempohora = reloj.getHours()+resto;\n         \n         regando = true;\n        \n        context.set('Tiempohora', tiempohora);\n        context.set('Tiempomin', tiempomin);\n        flow.set('Regando', regando);\n       msg.payload = \"inician riego en sector \" + indice + \" finaliza a las \" + tiempohora + \":\" + tiempomin;\n       msg.canal = indice;\n       msg.estado = \"on\";\n       return msg;\n    }\n    \n    /* comprueba el riego por canal una vez iniciado\n    carga hora y minutos y los compara con los guardados\n    si coinciden reinicia las variables para proximo ciclo */\n    \n    if(regando === true){\n        \n       if(tiempohora === reloj.getHours() && tiempomin === reloj.getMinutes()){\n           \n            regando = false;\n            \n            tiempohora = 0;\n            tiempomin = 0;\n            context.set('Tiempohora', tiempohora);\n            context.set('Tiempomin', tiempomin);\n            //funcionando = false;\n            \n            flow.set('Regando', regando);\n        \n            msg.canal = indice;\n            msg.estado = \"off\";\n            msg.final = \"no\";\n            indice += 1;\n            context.set('Indice', indice);\n            return msg;\n       }\n        \n        return;\n    }\n    \n    /*comprueba si canal contiene 0 en tiempo y pasa a siguiente*/\n    if(matriz[indice] === 0){\n            regando = false;\n            \n            tiempohora = 0;\n            tiempomin = 0;\n            context.set('Tiempohora', tiempohora);\n            context.set('Tiempomin', tiempomin);\n            indice += 1;\n            context.set('Indice', indice);\n        \n            flow.set('Regando', regando);\n            return;\n        \n    }\n\n    \n    \n    return null;","outputs":1,"noerr":0,"x":920,"y":300,"wires":[["d75a4884.abb418"]]},{"id":"c16262d.d5baaa","type":"switch","z":"f25737d2.a56978","name":"mensaje vacio","property":"payload","propertyType":"msg","rules":[{"t":"nempty"},{"t":"empty"}],"checkall":"true","repair":false,"outputs":2,"x":920,"y":440,"wires":[["23eeb430.8586cc","f0d6449a.7c7e98","8840ccb5.2df3"],[]]},{"id":"eddc167.6578de8","type":"telegrambot-notify","z":"d790f34d.d1733","name":"","bot":"16412209.8f2dee","chatId":"594372466","message":"Hola!!! vuelvo a estar activo","parseMode":"","x":500,"y":220,"wires":[]},{"id":"bba1e7c4.382818","type":"inject","z":"d790f34d.d1733","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":130,"y":220,"wires":[["2dd6e2df.e6935e","9a9a7af3.1aeab8"]]},{"id":"23eeb430.8586cc","type":"function","z":"f25737d2.a56978","name":"Aviso Telegram inicio","func":"if(msg.payload.status === \"on\"){\nmsg.payload = \"Riego iniciado en canal \" + msg.payload.canal;\nreturn msg;\n}\n\nreturn","outputs":1,"noerr":0,"x":1220,"y":360,"wires":[["4fdf0491.01352c"]]},{"id":"4fdf0491.01352c","type":"telegrambot-notify","z":"f25737d2.a56978","name":"aviso inicio riego","bot":"16412209.8f2dee","chatId":"594372466","message":"","parseMode":"","x":1450,"y":360,"wires":[]},{"id":"f0d6449a.7c7e98","type":"function","z":"f25737d2.a56978","name":"Aviso Telegram fin","func":"if( msg.payload.final === \"finalizado\"){\nreturn msg;\n}\n\nreturn","outputs":1,"noerr":0,"x":1230,"y":420,"wires":[["a5929e98.0b77e"]]},{"id":"a5929e98.0b77e","type":"telegrambot-notify","z":"f25737d2.a56978","name":"aviso fin riego","bot":"16412209.8f2dee","chatId":"594372466","message":"Riego automatico finalizado!","parseMode":"","x":1440,"y":420,"wires":[]},{"id":"cb905817.ba3728","type":"inject","z":"f25737d2.a56978","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"1","x":110,"y":120,"wires":[["27ecd623.2dc80a","e40ec5af.914558"]]},{"id":"27ecd623.2dc80a","type":"change","z":"f25737d2.a56978","name":"","rules":[{"t":"set","p":"Activo","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"Regando","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"DeviceStatus","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":120,"wires":[[]]},{"id":"6df372e0.87350c","type":"inject","z":"d790f34d.d1733","name":"","topic":"SELECT * FROM `casa`","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"1","x":230,"y":520,"wires":[["57e6a097.c9128"]]},{"id":"dc276387.9cba4","type":"telegrambot-command","z":"f25737d2.a56978","name":"reactivar","bot":"16412209.8f2dee","command":"/reset","commandType":"str","commandCase":false,"x":600,"y":120,"wires":[["b01a59bd.5ee3b8"]]},{"id":"b01a59bd.5ee3b8","type":"telegrambot-notify","z":"f25737d2.a56978","name":"aviso inicio riego","bot":"16412209.8f2dee","chatId":"594372466","message":"ok","parseMode":"","x":810,"y":120,"wires":[]},{"id":"57e6a097.c9128","type":"mysql","z":"d790f34d.d1733","mydb":"c6a120a5.09b4f","name":"","x":460,"y":520,"wires":[["b464b3e1.52cf5"]]},{"id":"b464b3e1.52cf5","type":"ui_template","z":"d790f34d.d1733","group":"a7cf1fe4.c0ab9","name":"dispositivos","order":1,"width":"12","height":"12","format":"<style type=\"text/css\"> @import url(\"/styles/dispositives.css\"); </style>\n<table id=\"table\" border=\"5\">\n <tr>\n <th>Nombre</th>\n  <th>Categoria</th>\n  <th>Uso del Disp</th>\n </tr>\n <tbody>\n <tr ng-repeat=\"row in listaDispositivos\" >\n <td class=\"nombres\" ng-click=\"borrar($index)\">{{row.Nombre}}</td>\n <td class=\"categorias\">{{row.categoria}}</td>\n <td class=\"categorias\">{{row.uso}}</td>\n </tr>\n </tbody>\n</table>\n\n\n<script>\n\n    (function(scope){\n       scope.$watch('msg.payload', function(data, oldData){\n           \n           if(data===oldData) return;\n           \n           scope.listaDispositivos = data;\n\n           scope.borrar = function(indice){\n               console.log(data[indice].Nombre);\n               scope.send({payload : data[indice].Nombre});\n           }\n       });\n    \n    })(scope);\n    \n</script>","storeOutMessages":false,"fwdInMessages":true,"templateScope":"local","x":630,"y":520,"wires":[["84b0a3d5.8b6c6"]]},{"id":"6c9f911b.51a18","type":"debug","z":"d790f34d.d1733","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1570,"y":520,"wires":[]},{"id":"e40ec5af.914558","type":"file in","z":"f25737d2.a56978","name":"carga riego.json","filename":"resources/configuraciones/riego.json","format":"utf8","chunk":false,"sendError":false,"x":340,"y":220,"wires":[["621ede83.13d51"]]},{"id":"621ede83.13d51","type":"json","z":"f25737d2.a56978","name":"configuracionRiego","property":"payload","action":"obj","pretty":false,"x":570,"y":220,"wires":[["745639a7.d8b188"]]},{"id":"745639a7.d8b188","type":"change","z":"f25737d2.a56978","name":"","rules":[{"t":"set","p":"DatosRiegoLocal","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":200,"wires":[[]]},{"id":"1f03a832.81f318","type":"ui_template","z":"c88d6057.281f6","group":"1e9b1326.5b8a7d","name":"Horario Dia","order":13,"width":0,"height":0,"format":"<style type=\"text/css\"> @import url(\"/styles/termostato.css\");</style>\n\n    <div id=\"cajas\">\n        <label id=\"etiquetas\">Horario de dia</label><br>\n    </div>\n    <div>\n    <label>Inicio&nbsp;&nbsp;</label>\n    \n    <input ng-model=\"hora.dia\" \n           type=\"number\"\n           id=\"diafin\"\n           min=\"0\" max=\"23\"\n           value=\"{{msg.payload[0]}}\" \n           ng-change=\"msg.payload[0] = hora.dia; send(msg)\">\n    <label>:</label>\n    \n    <input ng-model=\"minutos.dia\" \n           type=\"number\"\n           id=\"diafin\"\n           min=\"0\" max=\"59\"\n           value=\"{{msg.payload[1]}}\" \n           ng-change=\"msg.payload[1] = minutos.dia; send(msg)\">\n           \n    <label>&nbsp;&nbsp;Fin&nbsp;&nbsp;</label>\n    \n    <input ng-model=\"hora.diafin\" \n           type=\"number\"\n           id=\"diafin\"\n           min=\"0\" max=\"23\"\n           value=\"{{msg.payload[2]}}\" \n           ng-change=\"msg.payload[2] = hora.diafin; send(msg)\">\n           \n    <label>:</label>\n    \n    <input ng-model=\"minutos.diafin\" \n           type=\"number\"\n           id=\"diafin\"\n           min=\"0\" max=\"59\"\n           value=\"{{msg.payload[3]}}\" \n           ng-change=\"msg.payload[3] = minutos.diafin; send(msg)\">\n    </div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":430,"y":540,"wires":[["53438aa6.f75564"]]},{"id":"56facf22.446c8","type":"ui_template","z":"c88d6057.281f6","group":"1e9b1326.5b8a7d","name":"Horario Noche","order":17,"width":0,"height":0,"format":"<style type=\"text/css\"> @import url(\"/styles/termostato.css\");</style>\n\n<div id=\"cajas\">\n<label id=\"etiquetas\">Horario de Noche</label>\n</div>\n<div>\n<label>Inicio&nbsp;&nbsp;</label>\n<input ng-model=\"hora.dia\" \n       type=\"number\"\n       id=\"noche\"\n       min=\"0\" max=\"23\"\n       value=\"{{msg.payload[0]}}\" \n       ng-change=\"msg.payload[0] = hora.dia; send(msg)\">\n<label>:</label>\n<input ng-model=\"minutos.dia\" \n       type=\"number\"\n       id=\"noche\"\n       min=\"0\" max=\"59\"\n       value=\"{{msg.payload[1]}}\" \n       ng-change=\"msg.payload[1] = minutos.dia; send(msg)\">\n<label>&nbsp;&nbsp;Fin&nbsp;&nbsp;</label>\n<input ng-model=\"hora.diafin\" \n       type=\"number\"\n       id=\"noche\"\n       min=\"0\" max=\"23\"\n       value=\"{{msg.payload[2]}}\" \n       ng-change=\"msg.payload[2] = hora.diafin; send(msg)\">\n<label>:</label>\n<input ng-model=\"minutos.diafin\" \n       type=\"number\"\n       id=\"noche\"\n       min=\"0\" max=\"59\"\n       value=\"{{msg.payload[3]}}\" \n       ng-change=\"msg.payload[3] = minutos.diafin; send(msg)\">\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":460,"y":600,"wires":[["6f0e04fe.884cbc"]]},{"id":"c28a2cd6.d7fd8","type":"ui_slider","z":"c88d6057.281f6","name":"","label":"TempDia","tooltip":"","group":"1e9b1326.5b8a7d","order":10,"width":"7","height":"1","passthru":true,"outs":"all","topic":"","min":0,"max":"30","step":1,"x":500,"y":320,"wires":[["b1e03ff8.a8ff","2cc178f2.c77d88"]]},{"id":"2cc178f2.c77d88","type":"ui_text","z":"c88d6057.281f6","group":"1e9b1326.5b8a7d","order":11,"width":"3","height":"1","name":"","label":"","format":"{{msg.payload}}Cº","layout":"row-left","x":650,"y":320,"wires":[]},{"id":"ec6d1009.bbdff","type":"ui_slider","z":"c88d6057.281f6","name":"","label":"Temp","tooltip":"","group":"1e9b1326.5b8a7d","order":14,"width":"7","height":"1","passthru":true,"outs":"all","topic":"","min":0,"max":"30","step":1,"x":485,"y":420,"wires":[["8de7c969.756fa8","7b86a000.09267"]]},{"id":"8de7c969.756fa8","type":"ui_text","z":"c88d6057.281f6","group":"1e9b1326.5b8a7d","order":15,"width":"3","height":"1","name":"","label":"","format":"{{msg.payload}}Cº","layout":"row-left","x":645,"y":420,"wires":[]},{"id":"1573320.85c94ce","type":"file in","z":"c88d6057.281f6","name":"termostato.json","filename":"resources/configuraciones/termostato.json","format":"utf8","chunk":false,"sendError":false,"x":420,"y":200,"wires":[["64e547.75e48ab8"]]},{"id":"64e547.75e48ab8","type":"json","z":"c88d6057.281f6","name":"","property":"payload","action":"","pretty":false,"x":610,"y":200,"wires":[["4924ce90.e50bd"]]},{"id":"4924ce90.e50bd","type":"change","z":"c88d6057.281f6","name":"Termostato","rules":[{"t":"set","p":"termostato","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":200,"wires":[["6656ef43.04a05"]]},{"id":"c1dccc4d.1f2c6","type":"inject","z":"c88d6057.281f6","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":170,"y":200,"wires":[["1573320.85c94ce"]]},{"id":"9682247e.7cd058","type":"debug","z":"c88d6057.281f6","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":650,"y":660,"wires":[]},{"id":"174e556.8f491ab","type":"change","z":"c88d6057.281f6","name":"hora dia","rules":[{"t":"set","p":"payload","pt":"msg","to":"termostato.HoraDia","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":540,"wires":[["1f03a832.81f318"]]},{"id":"53438aa6.f75564","type":"change","z":"c88d6057.281f6","name":"cambiaHoraDia","rules":[{"t":"set","p":"termostato.HoraDia","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":540,"wires":[[]]},{"id":"fbe2c05e.a4336","type":"change","z":"c88d6057.281f6","name":"hora Noche","rules":[{"t":"set","p":"payload","pt":"msg","to":"termostato.HoraNoche","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":600,"wires":[["56facf22.446c8"]]},{"id":"6f0e04fe.884cbc","type":"change","z":"c88d6057.281f6","name":"cambiaHoraNoche","rules":[{"t":"set","p":"termostato.HoraNoche","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":600,"wires":[[]]},{"id":"3622fb1c.a79e74","type":"ui_button","z":"c88d6057.281f6","name":"","group":"1e9b1326.5b8a7d","order":18,"width":"3","height":"2","passthru":false,"label":"Guardar","tooltip":"","color":"","bgcolor":"","icon":"save","payload":"termostato","payloadType":"flow","topic":"","x":100,"y":740,"wires":[["39718139.8c5b8e"]]},{"id":"60bea023.4b655","type":"link in","z":"c88d6057.281f6","name":"inyecta","links":["6656ef43.04a05"],"x":155,"y":540,"wires":[["174e556.8f491ab","fbe2c05e.a4336"]]},{"id":"6656ef43.04a05","type":"link out","z":"c88d6057.281f6","name":"salida config","links":["60bea023.4b655","99bcafd3.5f957"],"x":935,"y":200,"wires":[]},{"id":"fb55e7.65c4da18","type":"ui_switch","z":"c88d6057.281f6","name":"","label":"OnOff","tooltip":"","group":"1e9b1326.5b8a7d","order":1,"width":"4","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":490,"y":260,"wires":[["6434f219.38e3bc"]]},{"id":"7142cbe3.8df544","type":"function","z":"c88d6057.281f6","name":"Envia datos","func":"var matriz = flow.get('termostato');\nmsg.payload = matriz.OnOff\nvar tempDia = {payload: matriz.tempDia}\nvar tempNoche = {payload: matriz.tempNoche}\nreturn [msg, tempDia, tempNoche];","outputs":3,"noerr":0,"x":290,"y":320,"wires":[["fb55e7.65c4da18"],["c28a2cd6.d7fd8"],["ec6d1009.bbdff"]]},{"id":"ccf9c342.04297","type":"file","z":"c88d6057.281f6","name":"guarda temperatura","filename":"resources/configuraciones/termostato.json","appendNewline":true,"createDir":false,"overwriteFile":"true","x":550,"y":840,"wires":[[]]},{"id":"6434f219.38e3bc","type":"change","z":"c88d6057.281f6","name":"set on-off","rules":[{"t":"set","p":"termostato.OnOff","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":260,"wires":[[]]},{"id":"b1e03ff8.a8ff","type":"change","z":"c88d6057.281f6","name":"set temp dia","rules":[{"t":"set","p":"termostato.tempDia","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":360,"wires":[[]]},{"id":"7b86a000.09267","type":"change","z":"c88d6057.281f6","name":"set temp dia","rules":[{"t":"set","p":"termostato.tempNoche","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":665,"y":460,"wires":[[]]},{"id":"a188c791.170b08","type":"inject","z":"d790f34d.d1733","name":"","topic":"","payload":"nuevosDispositivos","payloadType":"flow","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":400,"wires":[["cac121f.c816ee"]]},{"id":"cac121f.c816ee","type":"debug","z":"d790f34d.d1733","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":560,"y":400,"wires":[]},{"id":"8da46aa.f34fb98","type":"watch","z":"f25737d2.a56978","name":"cambios en riego","files":"resources/configuraciones/riego.json","recursive":"","x":120,"y":220,"wires":[["e40ec5af.914558"]]},{"id":"bba00c09.977c1","type":"ui_ui_control","z":"d790f34d.d1733","name":"Pagina Inicio","x":490,"y":280,"wires":[[]]},{"id":"2dd6e2df.e6935e","type":"change","z":"d790f34d.d1733","name":"Set Home","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Home\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":280,"wires":[["bba00c09.977c1"]]},{"id":"639e2dbd.704914","type":"ui_ui_control","z":"d790f34d.d1733","name":"","x":280,"y":660,"wires":[["1101b705.62e209"]]},{"id":"1101b705.62e209","type":"change","z":"d790f34d.d1733","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"SELECT * FROM `casa`","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":580,"wires":[["57e6a097.c9128"]]},{"id":"cb568a7.19ffb78","type":"link in","z":"d790f34d.d1733","name":"registraIn","links":["5f4c0723.802998","52fe3ae3.4c5724"],"x":255,"y":460,"wires":[["58e45509.7da13c"]]},{"id":"d52a67d3.082798","type":"mqtt in","z":"562c7a8f.cd8d24","name":"Nuevos dispositivos","topic":"devices/#","qos":"1","broker":"353193e2.3064fc","x":110,"y":180,"wires":[["1b84a1bc.cba4ee"]]},{"id":"1b84a1bc.cba4ee","type":"json","z":"562c7a8f.cd8d24","name":"","property":"payload","action":"","pretty":false,"x":270,"y":180,"wires":[["d85f950a.2231f8"]]},{"id":"a0e62eca.35f69","type":"ui_toast","z":"d790f34d.d1733","position":"dialog","displayTime":"3","highlight":"","outputs":1,"ok":"OK","cancel":"CANCEL","topic":"¿Desea eliminar este dispositivo?","name":"","x":1110,"y":520,"wires":[["322783ae.de9cbc"]]},{"id":"322783ae.de9cbc","type":"function","z":"d790f34d.d1733","name":"borra fila","func":"var nombre = flow.get('temporal');\nif(msg.payload===\"OK\"){\n    var borrar = \"DELETE FROM casa WHERE Nombre = \" + \"'\" + nombre + \"'\";\n    msg.topic = borrar;\n    return msg;\n}\nreturn;","outputs":1,"noerr":0,"x":1260,"y":520,"wires":[["145f89e7.eb0456"]]},{"id":"145f89e7.eb0456","type":"mysql","z":"d790f34d.d1733","mydb":"c6a120a5.09b4f","name":"","x":1400,"y":520,"wires":[["6c9f911b.51a18","dcaf0c84.de8d2"]]},{"id":"7f1cbfe8.aba4e","type":"ui_ui_control","z":"d790f34d.d1733","name":"","x":1280,"y":700,"wires":[[]]},{"id":"dcaf0c84.de8d2","type":"function","z":"d790f34d.d1733","name":"refresca pag.","func":"msg.payload = {\n    \"tab\" : \"\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":1130,"y":700,"wires":[["7f1cbfe8.aba4e"]]},{"id":"eda30b05.e586e8","type":"ui_template","z":"562c7a8f.cd8d24","group":"eb82bc63.c77d7","name":"Nuevos dispositivos","order":0,"width":"7","height":"10","format":"<md-container >\n\n<div ng-bind-html= \"dispositivo\"></div>\n\n<hr>\n\n<label>Elija uso del dispositivo</label>\n<hr>\n<md-radio-group ng-model=\"$parent.uso\">\n\n      <md-radio-button ng-disabled=\"riegoStatus===true\" value=\"riego\" class=\"md-primary\">Riego</md-radio-button>\n      <md-radio-button ng-disabled=\"activo===true\" value=\"luces\">Luces</md-radio-button>\n      <md-radio-button ng-disabled=\"activo===true\" value=\"calefaccion\">Calefaccion</md-radio-button>\n      <md-radio-button ng-disabled=\"activo===true\" value=\"persianas\">Persianas</md-radio-button>\n\n</md-radio-group>\n<hr>\n<div>\n    <div class=\"idName\">\n        <md-button ng-click=\"guardar(uso)\">Guardar</md-button>\n    </div>\n<hr><hr>\n    <div class=\"idName\">\n        <md-button ng-click=\"reset()\">Reset</md-button>\n    </div>\n</div>\n\n</md-container>\n\n<script>\n\nscope.activo = true;\nscope.riegoStatus = true;\n(function(scope){\n    \n    scope.dispositivo = \"No hay dispositivos nuevos\";\n    \n    scope.$watch('msg', function(msg,oldvalue){\n        scope.riegoStatus = msg.payload.registroRiego;\n        if(msg===oldvalue){\n            return;\n        }\n     \n        if(msg){\n            if(msg.payload==null) return;\n            if(typeof msg.payload == \"object\"){\n                scope.activo = false;\n                scope.dispositivo = msg.payload.id;\n                \n            }\n            \n        }\n        \n        scope.guardar = function(uso){\n            if(scope.dispositivo!=\"No hay dispositivos nuevos\"){\n                if(uso===undefined){\n                    alert(\"seleccione un uso para este dispositivo\");\n                    return;\n                }\n                msg.payload.uso = uso;\n                msg.payload.tab = \"\";\n                msg.payload.guardar = true;\n                scope.send(scope.msg);\n                msg = oldvalue;\n                scope.activo = true;\n                scope.dispositivo = \"hay dispositivos nuevos\";\n            }\n        }\n        \n        scope.reset = function(){\n                scope.riegoStatus = true;\n                scope.activo = true;\n                scope.dispositivo = \"hay dispositivos nuevos\";\n        }\n        \n    });\n    \n})(scope);\n\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":380,"y":380,"wires":[["690eef5f.3ee","bc89abb1.064cf8"]]},{"id":"690eef5f.3ee","type":"switch","z":"562c7a8f.cd8d24","name":"","property":"payload.guardar","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":580,"y":380,"wires":[["3f6cc24e.ccc07e","490099f1.30e2a8"]]},{"id":"3f6cc24e.ccc07e","type":"function","z":"562c7a8f.cd8d24","name":"MYSQL Query","func":"var campos = msg.payload;\n\nvar topic = \"INSERT IGNORE INTO casa (Nombre, Canales, categoria, uso) VALUES (\";\ntopic += \"\\\"\";\ntopic += campos.id;\ntopic += \"\\\"\";\ntopic += ',';\ntopic += \"\\\"\";\ntopic += campos.canales;\ntopic += \"\\\"\";\ntopic += ',';\ntopic += \"\\\"\";\ntopic += campos.categoria;\ntopic += \"\\\"\";\ntopic += ',';\ntopic += \"\\\"\";\ntopic += campos.uso;\ntopic += \"\\\"\";\ntopic += \")\";\n\nmsg.topic = topic;\nmsg.payload = campos; \nreturn msg;","outputs":1,"noerr":0,"x":730,"y":380,"wires":[["c2e6e19e.ecf04"]]},{"id":"c2e6e19e.ecf04","type":"mysql","z":"562c7a8f.cd8d24","mydb":"c6a120a5.09b4f","name":"registraDevices","x":930,"y":380,"wires":[["decdb707.fe05c8","bf04f6ca.bfa918"]]},{"id":"decdb707.fe05c8","type":"switch","z":"562c7a8f.cd8d24","name":"","property":"payload.warningCount","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":310,"y":460,"wires":[["a1158102.59667","287df0ed.720de"],["ff251b32.d1ecd8"]]},{"id":"ff251b32.d1ecd8","type":"ui_toast","z":"562c7a8f.cd8d24","position":"dialog","displayTime":"10","highlight":"","outputs":1,"ok":"OK","cancel":"","topic":"No se pudo guardar. cambie el nombre a su dispositivo","name":"","x":320,"y":540,"wires":[[]]},{"id":"a1158102.59667","type":"ui_toast","z":"562c7a8f.cd8d24","position":"dialog","displayTime":"10","highlight":"","outputs":1,"ok":"OK","cancel":"","topic":"Dispositivo agregado a la base de datos","name":"","x":520,"y":460,"wires":[[]]},{"id":"287df0ed.720de","type":"change","z":"562c7a8f.cd8d24","name":"RegistResp","rules":[{"t":"set","p":"nuevosDispositivos","pt":"flow","to":"none","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":540,"wires":[["4ad0e788.26d4b8"]]},{"id":"4ad0e788.26d4b8","type":"change","z":"562c7a8f.cd8d24","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"canal\":1,\"status\":\"serverSwitch\"}","tot":"json"},{"t":"set","p":"topic","pt":"msg","to":"SELECT * FROM `casa`","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":540,"wires":[["85fa277d.44d278","52fe3ae3.4c5724","591dc36.fdef03c","ee83d236.364dd","132a7236.05d30e"]]},{"id":"52fe3ae3.4c5724","type":"link out","z":"562c7a8f.cd8d24","name":"registraOut","links":["cb568a7.19ffb78"],"x":965,"y":580,"wires":[]},{"id":"85fa277d.44d278","type":"mqtt out","z":"562c7a8f.cd8d24","name":"","topic":"device/setup","qos":"0","retain":"","broker":"353193e2.3064fc","x":930,"y":520,"wires":[]},{"id":"58e45509.7da13c","type":"change","z":"d790f34d.d1733","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Home\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":140,"y":620,"wires":[["639e2dbd.704914"]]},{"id":"490099f1.30e2a8","type":"ui_ui_control","z":"562c7a8f.cd8d24","name":"","x":710,"y":320,"wires":[[]]},{"id":"84b0a3d5.8b6c6","type":"switch","z":"d790f34d.d1733","name":"","property":"payload","propertyType":"msg","rules":[{"t":"istype","v":"string","vt":"string"}],"checkall":"true","repair":false,"outputs":1,"x":770,"y":520,"wires":[["f81f79ea.0a5f98"]]},{"id":"f81f79ea.0a5f98","type":"change","z":"d790f34d.d1733","name":"","rules":[{"t":"set","p":"temporal","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":520,"wires":[["a0e62eca.35f69"]]},{"id":"591dc36.fdef03c","type":"file in","z":"562c7a8f.cd8d24","name":"carga riego.json","filename":"resources/configuraciones/riego.json","format":"utf8","chunk":false,"sendError":true,"x":780,"y":640,"wires":[["9e51dfe6.52f28"]]},{"id":"9e51dfe6.52f28","type":"json","z":"562c7a8f.cd8d24","name":"configuracionRiego","property":"payload","action":"obj","pretty":false,"x":990,"y":640,"wires":[["c67bd2bb.b0bd8"]]},{"id":"c67bd2bb.b0bd8","type":"change","z":"562c7a8f.cd8d24","name":"","rules":[{"t":"set","p":"DatosRiego","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1220,"y":640,"wires":[["654e194.5e023e8"]]},{"id":"4a171032.fd456","type":"inject","z":"562c7a8f.cd8d24","name":"","topic":"","payload":"{\"id\":\"gas\",\"Canales\":\"1\",\"categoria\":\"habitaciones\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":70,"y":300,"wires":[["d85f950a.2231f8"]]},{"id":"654e194.5e023e8","type":"function","z":"562c7a8f.cd8d24","name":"setRiegoActivo","func":"var temp = flow.get('DatosRiego');\nvar tempuso = flow.get('usoDispositivo');\nif(tempuso===\"riego\"){\n    temp.registroRiego = true;\n    flow.set('DatosRiego', temp);\n}\nvar temp = flow.get('DatosRiego');\nmsg.payload = temp;\nreturn msg;","outputs":1,"noerr":0,"x":1220,"y":700,"wires":[["9b48ae81.138ef"]]},{"id":"bc89abb1.064cf8","type":"function","z":"562c7a8f.cd8d24","name":"guardoUso","func":"var uso = msg.payload.uso;\nflow.set('usoDispositivo', uso);\nvar verUso = flow.get('usoDispositivo');\nmsg.payload = verUso;\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":280,"wires":[[]]},{"id":"9b48ae81.138ef","type":"file","z":"562c7a8f.cd8d24","name":"guardaRiegoTrue","filename":"resources/configuraciones/riego.json","appendNewline":false,"createDir":false,"overwriteFile":"true","x":1230,"y":760,"wires":[[]]},{"id":"f4ac51b.a364fb","type":"inject","z":"d7ce74a.43e7388","name":"ON","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"x":230,"y":1040,"wires":[["a9957289.3c5b7"]]},{"id":"efe4b5cf.e8e7c8","type":"inject","z":"d7ce74a.43e7388","name":"OFF","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"x":230,"y":1080,"wires":[["a9957289.3c5b7"]]},{"id":"20349c6.588fa64","type":"debug","z":"d7ce74a.43e7388","name":"","active":true,"console":"false","complete":"false","x":650,"y":1060,"wires":[]},{"id":"a9957289.3c5b7","type":"change","z":"d7ce74a.43e7388","name":"Enable / Disable this flow","rules":[{"t":"set","p":"start-stop","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":1060,"wires":[["20349c6.588fa64"]]},{"id":"9795264d.7f9c68","type":"switch","z":"d7ce74a.43e7388","name":"","property":"DatosRiego.registroRiego","propertyType":"flow","rules":[{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":160,"wires":[["19c54a41.fde856"],["3458af6a.c8546"]]},{"id":"19c54a41.fde856","type":"change","z":"d7ce74a.43e7388","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"group\":{\"hide\":[\"Riego_Dias\",\"Riego_Horas\",\"Riego_Tiempos\",\"Riego_Acciones\"]}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":880,"y":100,"wires":[["1807c7ca.1e7ee8"]]},{"id":"1807c7ca.1e7ee8","type":"ui_ui_control","z":"d7ce74a.43e7388","name":"","x":1100,"y":100,"wires":[["161971ba.d5a07e"]]},{"id":"3458af6a.c8546","type":"change","z":"d7ce74a.43e7388","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"group\":{\"hide\":[\"Riego_registra\"],\"show\":[\"Riego_Dias\",\"Riego_Horas\",\"Riego_Tiempos\",\"Riego_Acciones\"]}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":180,"wires":[["a36a9fae.a2918"]]},{"id":"a36a9fae.a2918","type":"ui_ui_control","z":"d7ce74a.43e7388","name":"","x":1120,"y":180,"wires":[[]]},{"id":"161971ba.d5a07e","type":"ui_text","z":"d7ce74a.43e7388","group":"7f7b5dc3.331514","order":0,"width":0,"height":0,"name":"","label":"text","format":"{{msg.payload}}","layout":"row-spread","x":1280,"y":100,"wires":[]},{"id":"c31b6aa9.48f1e8","type":"function","z":"f25737d2.a56978","name":"SiRegistrado","func":"var temp = flow.get('DatosRiegoLocal');\nif(temp.registroRiego===true){\nreturn msg;\n}else{return;}","outputs":1,"noerr":0,"x":370,"y":300,"wires":[["390179be.3454d6"]]},{"id":"41061115.58f7b","type":"catch","z":"d7ce74a.43e7388","name":"","scope":["e2f26495.f02f58"],"x":230,"y":1240,"wires":[["20349c6.588fa64","56e816fb.5f7738"]]},{"id":"d3ec5354.e4465","type":"change","z":"d7ce74a.43e7388","name":"","rules":[{"t":"set","p":"DatosRiego","pt":"flow","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":1240,"wires":[["c8c1e91a.349278"]]},{"id":"ef057c3f.a4478","type":"ui_ui_control","z":"d7ce74a.43e7388","name":"","x":1060,"y":1240,"wires":[[]]},{"id":"c8c1e91a.349278","type":"change","z":"d7ce74a.43e7388","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1240,"wires":[["ef057c3f.a4478"]]},{"id":"56e816fb.5f7738","type":"switch","z":"d7ce74a.43e7388","name":"","property":"payload","propertyType":"msg","rules":[{"t":"istype","v":"number","vt":"number"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":1240,"wires":[["d3ec5354.e4465"],[]]},{"id":"5effbf55.13342","type":"file in","z":"562c7a8f.cd8d24","name":"carga riego","filename":"resources/configuraciones/riego.json","format":"utf8","chunk":false,"sendError":false,"x":550,"y":180,"wires":[["55319766.f41ee8"]]},{"id":"cf2f78b1.e3dbf8","type":"change","z":"562c7a8f.cd8d24","name":"addRiego","rules":[{"t":"set","p":"registroRiego.registroRiego","pt":"flow","to":"payload.registroRiego","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":180,"wires":[["f04d9831.1824c8"]]},{"id":"d85f950a.2231f8","type":"change","z":"562c7a8f.cd8d24","name":"tempVar","rules":[{"t":"set","p":"registroRiego","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":180,"wires":[["5effbf55.13342"]]},{"id":"55319766.f41ee8","type":"json","z":"562c7a8f.cd8d24","name":"","property":"payload","action":"","pretty":false,"x":690,"y":180,"wires":[["cf2f78b1.e3dbf8"]]},{"id":"f04d9831.1824c8","type":"change","z":"562c7a8f.cd8d24","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"registroRiego","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":180,"wires":[["ea89b3ac.5ef76"]]},{"id":"a31e975f.c19e48","type":"file in","z":"9735dbc5.e84748","name":"cargaConfig","filename":"resources/configuraciones/termostato.json","format":"utf8","chunk":false,"sendError":false,"x":290,"y":740,"wires":[["e93601c7.870fa"]]},{"id":"a990b122.84cc6","type":"inject","z":"9735dbc5.e84748","name":"","topic":"","payload":"","payloadType":"date","repeat":"10","crontab":"","once":true,"onceDelay":0.1,"x":110,"y":840,"wires":[["18f5ef0a.b65681"]]},{"id":"e93601c7.870fa","type":"json","z":"9735dbc5.e84748","name":"calefaccionJson","property":"payload","action":"obj","pretty":false,"x":460,"y":740,"wires":[["bcdcfff9.3801e"]]},{"id":"bcdcfff9.3801e","type":"change","z":"9735dbc5.e84748","name":"datos calefaccion","rules":[{"t":"set","p":"DatosCalefaccion","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":740,"wires":[[]]},{"id":"55d91303.54b93c","type":"ui_gauge","z":"9735dbc5.e84748","name":"","group":"1e9b1326.5b8a7d","order":6,"width":"5","height":"5","gtype":"gage","title":"Salon","label":"Grados","format":"{{value}}Cº","min":0,"max":"40","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":630,"y":520,"wires":[]},{"id":"eda52ce1.78593","type":"ui_gauge","z":"9735dbc5.e84748","name":"","group":"1e9b1326.5b8a7d","order":7,"width":"5","height":"5","gtype":"gage","title":"Habitaciones","label":"Grados","format":"{{value}}Cº","min":0,"max":"30","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":650,"y":580,"wires":[]},{"id":"5bb449c8.349ff8","type":"ui_gauge","z":"9735dbc5.e84748","name":"","group":"1e9b1326.5b8a7d","order":8,"width":"5","height":"5","gtype":"gage","title":"Estudio","label":"Grados","format":"{{value}}Cº","min":0,"max":"30","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":640,"y":640,"wires":[]},{"id":"ac3c2c34.ade7e","type":"inject","z":"9735dbc5.e84748","name":"","topic":"","payload":"21","payloadType":"num","repeat":"30","crontab":"","once":true,"onceDelay":0.1,"x":90,"y":580,"wires":[["c3fec51e.c01cd8","24b8751d.f8010a"]]},{"id":"b50b2485.516a08","type":"mqtt in","z":"9735dbc5.e84748","name":"Term Salon","topic":"serverSwitch/termostatos/salon/temp","qos":"1","broker":"353193e2.3064fc","x":90,"y":520,"wires":[["24b8751d.f8010a"]]},{"id":"90c5c778.0b1508","type":"link in","z":"562c7a8f.cd8d24","name":"nuevosDispoIn","links":["ea89b3ac.5ef76"],"x":195,"y":380,"wires":[["eda30b05.e586e8"]]},{"id":"ea89b3ac.5ef76","type":"link out","z":"562c7a8f.cd8d24","name":"nuevosDispoOut","links":["90c5c778.0b1508"],"x":1135,"y":240,"wires":[]},{"id":"24b8751d.f8010a","type":"change","z":"9735dbc5.e84748","name":"VarSalon","rules":[{"t":"set","p":"salon","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":520,"wires":[["55d91303.54b93c"]]},{"id":"804934b2.8e2ef8","type":"change","z":"9735dbc5.e84748","name":"VarHabitaciones","rules":[{"t":"set","p":"habitaciones","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":580,"wires":[["eda52ce1.78593"]]},{"id":"8a83a85d.5af3a8","type":"change","z":"9735dbc5.e84748","name":"VarEstudio","rules":[{"t":"set","p":"estudio","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":640,"wires":[["5bb449c8.349ff8"]]},{"id":"61380cf6.ed2f94","type":"function","z":"9735dbc5.e84748","name":"ControlCalefaccion","func":"var datos = flow.get('DatosCalefaccion');\nvar hora = new Date();\n\n/*\ncomprueba programacion de calefaccion\n*/\n\nif(((hora.getHours() == datos.HoraDia[0]) && (hora.getMinutes()>=datos.HoraDia[1] && hora.getMinutes()<=59)) || hora.getHours() > datos.HoraDia[0]){\n    \n    if(datos.HoraDia[0] > datos.HoraDia[2]){\n        \n        var Horas = (23 - hora.getHours()) + (datos.HoraDia[2]);\n        \n    }else{\n        Horas = datos.HoraDia[2] - hora.getHours();\n    }\n    \n    \n    if(Horas>0){\n    msg.payload = datos.tempDia;\n    return msg;\n    }\n    if(Horas===0){\n        if(hora.getMinutes()<datos.HoraDia[3]){\n            msg.payload = datos.tempDia;\n            return msg; \n        }\n    }\n}\n\nif((hora.getHours() == datos.HoraNoche[0]) && (hora.getMinutes()>=datos.HoraNoche[1] && hora.getMinutes()<=59) || hora.getHours() > datos.HoraNoche[0]){\n    \n    if(datos.HoraNoche[0] > datos.HoraNoche[2]){\n        \n        var HorasNoche = (23 - hora.getHours()) + (datos.HoraNoche[2]);\n        \n    }else{\n        HorasNoche = datos.HoraNoche[2] - hora.getHours();\n    }\n    \n    \n    if(HorasNoche>0){\n    msg.payload = datos.tempNoche;\n    return msg;\n    }\n    if(HorasNoche===0){\n        if(hora.getMinutes()<datos.HoraNoche[3]){\n            msg.payload = datos.tempNoche;\n            return msg; \n        }\n    }\n}\n    \nmsg.payload = 0;\nreturn msg;","outputs":1,"noerr":0,"x":130,"y":920,"wires":[["484eb6fc.e2a248"]]},{"id":"1f5e8c50.3e67b4","type":"inject","z":"9735dbc5.e84748","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":110,"y":740,"wires":[["a31e975f.c19e48"]]},{"id":"28f27215.eaf0be","type":"watch","z":"9735dbc5.e84748","name":"cambios en calefaccion","files":"resources/configuraciones/termostato.json","recursive":"","x":100,"y":700,"wires":[["a31e975f.c19e48"]]},{"id":"ee83d236.364dd","type":"debug","z":"562c7a8f.cd8d24","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":930,"y":480,"wires":[]},{"id":"53b7aee8.967d1","type":"ui_toast","z":"562c7a8f.cd8d24","position":"top right","displayTime":"3","highlight":"","outputs":0,"ok":"OK","cancel":"","topic":"","name":"","x":1060,"y":440,"wires":[]},{"id":"132a7236.05d30e","type":"change","z":"562c7a8f.cd8d24","name":"registro OK","rules":[{"t":"set","p":"payload","pt":"msg","to":"Dispositivo registrado!!!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":870,"y":440,"wires":[["53b7aee8.967d1"]]},{"id":"bf04f6ca.bfa918","type":"debug","z":"562c7a8f.cd8d24","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":1160,"y":340,"wires":[]},{"id":"9a9a7af3.1aeab8","type":"change","z":"d790f34d.d1733","name":"Globales Inicio","rules":[{"t":"set","p":"serverName","pt":"global","to":"serverSwitch","tot":"str"},{"t":"set","p":"actividadCalefaccion","pt":"global","to":"0","tot":"num"},{"t":"set","p":"actividadRiego","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":120,"wires":[[]]},{"id":"484eb6fc.e2a248","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"SetPoint","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":920,"wires":[["5ef92028.20ed2"]]},{"id":"7476dbe2.f39044","type":"inject","z":"9735dbc5.e84748","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":110,"y":420,"wires":[["14058e2b.4db7d2"]]},{"id":"14058e2b.4db7d2","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"salon","pt":"flow","to":"0","tot":"num"},{"t":"set","p":"habitaciones","pt":"flow","to":"0","tot":"num"},{"t":"set","p":"estudio","pt":"flow","to":"0","tot":"num"},{"t":"set","p":"ceroEnviado","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"lastState","pt":"flow","to":"vacio","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":420,"wires":[["2111ae0c.1a01a2"]]},{"id":"2eb0c9ef.eb8406","type":"function","z":"9735dbc5.e84748","name":"Control Caldera Y Valvulas","func":"\n//valor 1 equivale a circuito abierto\n//valor 0 equivale a circuito cerrado\n\nvar setpoint = flow.get('SetPoint');\nvar salon = flow.get('salon');\nvar hab = flow.get('habitaciones');\nvar estudio = flow.get('estudio');\n\nvar msg1 = {payload : null};\nvar msg2 = {payload : null};\nvar msg3 = {payload : null};\nvar msg4 = {payload : null};\n\nvar salonMenos = context.get('salonMenos') || false;\nvar salonMas = context.get('salonMas') || false;\n\nvar habMenos = context.get('habMenos') || false;\nvar habMas = context.get('habMas') || false;\n\nvar estudioMenos = context.get('estudioMenos') || false;\nvar estudioMas = context.get('estudioMas') || false;\n\nvar salonStat = context.get('salonStat') || \"On\";\nvar habStat = context.get('habStat') || \"On\";\nvar estudioStat = context.get('estudioStat') || \"On\";\nvar calderaStat = context.get('calderaStat') || \"Off\";\n\n    if(msg.payload == \"reset\"){\n        reseteaTodo()\n        return;\n    }\n\n\n    if(salon<setpoint && salonMenos === false){\n        msg1.payload = {\"canal\":1,\"status\":\"Off\"};\n        salonMenos=true;\n        context.set('salonMenos', salonMenos);\n        salonMas=false;\n        context.set('salonMas', salonMas);\n        salonStat=\"Off\";\n        context.set('salonStat', salonStat);\n    }\n    if(salon>=setpoint && salonMas === false){\n        msg1.payload = {\"canal\":1,\"status\":\"On\"};\n        salonMenos=false;\n        context.set('salonMenos', salonMenos);\n        salonMas=true;\n        context.set('salonMas', salonMas);\n        salonStat=\"On\";\n        context.set('salonStat', salonStat);\n    }\n    \n    if(hab<setpoint && habMenos === false){\n        msg2.payload = {\"canal\":2,\"status\":\"Off\"};\n        habMenos=true;\n        context.set('habMenos', habMenos);\n        habMas=false;\n        context.set('habMas', habMas);\n        habStat=\"Off\";\n        context.set('habStat', habStat);\n    }\n    if(hab>=setpoint && habMas === false){\n        msg2.payload = {\"canal\":2,\"status\":\"On\"};\n        habMenos=false;\n        context.set('habMenos', habMenos);\n        habMas=true;\n        context.set('habMas', habMas);\n        habStat=\"On\";\n        context.set('habStat', habStat);\n    }\n    \n    if(estudio<setpoint && estudioMenos === false){\n        msg3.payload = {\"canal\":3,\"status\":\"Off\"};\n        estudioMenos=true;\n        context.set('estudioMenos', estudioMenos);\n        estudioMas=false;\n        context.set('estudioMas', estudioMas);\n        estudioStat=\"Off\";\n        context.set('estudioStat', estudioStat);\n    }\n    if(estudio>=setpoint && estudioMas === false){\n        msg3.payload = {\"canal\":3,\"status\":\"On\"};\n        estudioMenos=false;\n        context.set('estudioMenos', estudioMenos);\n        estudioMas=true;\n        context.set('estudioMas', estudioMas);\n        estudioStat=\"On\";\n        context.set('estudioStat', estudioStat);\n    }\n    \n    if(salonStat ===\"On\" && habStat ===\"On\" && estudioStat ===\"On\" && calderaStat ===\"On\"){\n        msg4.payload = {\"canal\":4,\"status\":\"Off\"};\n        calderaStat=\"Off\";\n        context.set('calderaStat', calderaStat);\n    }\n    \n    if((salonStat ===\"Off\" || habStat ===\"Off\" || estudioStat ===\"Off\") && calderaStat ===\"Off\"){\n        msg4.payload = {\"canal\":4,\"status\":\"On\"};\n        calderaStat=\"On\";\n        context.set('calderaStat', calderaStat);\n    }\n\nvar lastState = {};\nlastState.salon = salonStat;\nlastState.hab = habStat;\nlastState.estudio = estudioStat;\nlastState.caldera = calderaStat;\n\nflow.set('lastState', lastState);\n\nreturn [msg1,msg2,msg3,msg4];\n\n\nfunction reseteaTodo(){\n    \n    salonMenos=false;\n    context.set('salonMenos', salonMenos);\n    salonMas=false;\n    context.set('salonMas', salonMas);\n    \n    habMenos=false;\n    context.set('habMenos', habMenos);\n    habMas=false;\n    context.set('habMas', habMas);\n    \n    estudioMenos=false;\n    context.set('estudioMenos', estudioMenos);\n    estudioMas=false;\n    context.set('estudioMas', estudioMas);\n    \n    salonStat=\"On\";\n    context.set('salonStat', salonStat);\n    \n    habStat=\"On\";\n    context.set('habStat', habStat);\n    \n    estudioStat=\"On\";\n    context.set('estudioStat', estudioStat);\n    \n    calderaStat=\"Off\";\n    context.set('calderaStat', calderaStat);\n    \n}","outputs":4,"noerr":0,"x":780,"y":920,"wires":[["59de7c09.7e1294"],["4d3cea3d.a371c4"],["27498cc2.b81254"],["df1b2b6a.fdd618"]]},{"id":"18f5ef0a.b65681","type":"switch","z":"9735dbc5.e84748","name":"","property":"DatosCalefaccion.OnOff","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":250,"y":840,"wires":[["61380cf6.ed2f94"]]},{"id":"90cab65b.6d02c8","type":"inject","z":"9735dbc5.e84748","name":"","topic":"","payload":"22","payloadType":"num","repeat":"30","crontab":"","once":true,"onceDelay":0.1,"x":90,"y":640,"wires":[["a71d83b6.e81b8"]]},{"id":"39718139.8c5b8e","type":"function","z":"c88d6057.281f6","name":"Comprueba","func":"var horario = flow.get('termostato');\nvar msgError = {};\nif(horario.HoraDia[2] == horario.HoraNoche[0] && horario.HoraDia[3] >= horario.HoraNoche[1]){\n    msgError = {payload : \"hora inicio noche debe ser mayor que fin dia\"};\n    return [msgError, null];\n}\nreturn [null, msg];","outputs":2,"noerr":0,"x":290,"y":740,"wires":[["9682247e.7cd058","c1e2b6bf.ad7c88"],["231e318e.f4d02e","ccf9c342.04297"]]},{"id":"c1e2b6bf.ad7c88","type":"ui_toast","z":"c88d6057.281f6","position":"dialog","displayTime":"3","highlight":"","outputs":1,"ok":"OK","cancel":"","topic":"","name":"","x":590,"y":720,"wires":[[]]},{"id":"231e318e.f4d02e","type":"debug","z":"c88d6057.281f6","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":550,"y":780,"wires":[]},{"id":"e43b408a.c3e01","type":"ui_button","z":"6749f74e.18d698","name":"Riego 1","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"1","payloadType":"num","topic":"","x":960,"y":620,"wires":[["2276863e.8c7d9a"]]},{"id":"84b4c804.0a0998","type":"debug","z":"9735dbc5.e84748","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1290,"y":1040,"wires":[]},{"id":"1d4f73c4.4ff18c","type":"debug","z":"9735dbc5.e84748","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1270,"y":840,"wires":[]},{"id":"f2f2f25b.ab773","type":"debug","z":"9735dbc5.e84748","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1290,"y":920,"wires":[]},{"id":"6aa5630a.c6857c","type":"debug","z":"9735dbc5.e84748","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1290,"y":980,"wires":[]},{"id":"59de7c09.7e1294","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1010,"y":860,"wires":[["1d4f73c4.4ff18c","5b36a3f3.1e835c","d49b7d82.584c1"]]},{"id":"4d3cea3d.a371c4","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1010,"y":900,"wires":[["f2f2f25b.ab773","8e71f1df.c48b1","ff8c65ab.03c958"]]},{"id":"27498cc2.b81254","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1010,"y":940,"wires":[["6aa5630a.c6857c","9f04a75e.a420d8","55805576.a714bc"]]},{"id":"df1b2b6a.fdd618","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1010,"y":980,"wires":[["84b4c804.0a0998","60bedacc.e1f874"]]},{"id":"2111ae0c.1a01a2","type":"function","z":"9735dbc5.e84748","name":"reset Caldera","func":"var msg1 ={};\nvar msg2 ={};\nvar msg3 ={};\nvar msg4 ={};\n\n\nmsg1.payload = {\"canal\":1,\"status\":\"Off\"};\nmsg2.payload = {\"canal\":2,\"status\":\"Off\"};\nmsg3.payload = {\"canal\":3,\"status\":\"Off\"};\nmsg4.payload = {\"canal\":4,\"status\":\"Off\"};\nreturn [msg1,msg2,msg3,msg4];","outputs":4,"noerr":0,"x":590,"y":420,"wires":[["3c19565f.c0945a"],["34c3e08b.58a34"],["ea09a05d.340fd"],["89dec6ae.9ff378"]]},{"id":"5ef92028.20ed2","type":"switch","z":"9735dbc5.e84748","name":"is 0?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":860,"wires":[["95636e78.224e9"],["d6eeed98.27285"]]},{"id":"fb7012f5.c6f94","type":"change","z":"9735dbc5.e84748","name":"enviado","rules":[{"t":"set","p":"ceroEnviado","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":780,"y":800,"wires":[["2111ae0c.1a01a2"]]},{"id":"95636e78.224e9","type":"switch","z":"9735dbc5.e84748","name":"enviado?","property":"ceroEnviado","propertyType":"flow","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":640,"y":820,"wires":[["fb7012f5.c6f94"]]},{"id":"d6eeed98.27285","type":"change","z":"9735dbc5.e84748","name":"enviado","rules":[{"t":"set","p":"ceroEnviado","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":980,"wires":[["2eb0c9ef.eb8406"]]},{"id":"3c19565f.c0945a","type":"link out","z":"9735dbc5.e84748","name":"salonRstOut","links":["dab655a4.84c8e8"],"x":815,"y":420,"wires":[]},{"id":"34c3e08b.58a34","type":"link out","z":"9735dbc5.e84748","name":"habRstOut","links":["255434f7.f92abc"],"x":815,"y":460,"wires":[]},{"id":"ea09a05d.340fd","type":"link out","z":"9735dbc5.e84748","name":"estudioRstOut","links":["ea16b119.e5546"],"x":815,"y":500,"wires":[]},{"id":"89dec6ae.9ff378","type":"link out","z":"9735dbc5.e84748","name":"calderaRstOut","links":["38ae23f0.a0d50c"],"x":815,"y":540,"wires":[]},{"id":"dab655a4.84c8e8","type":"link in","z":"9735dbc5.e84748","name":"salonIn","links":["3c19565f.c0945a","5b36a3f3.1e835c","6e50d8c1.7e5538"],"x":1035,"y":460,"wires":[["27a59f8e.1d3b8"]]},{"id":"255434f7.f92abc","type":"link in","z":"9735dbc5.e84748","name":"habIn","links":["34c3e08b.58a34","8e71f1df.c48b1","b1cb8e9d.d0c38"],"x":1035,"y":520,"wires":[["9838d46e.cc6fc8"]]},{"id":"ea16b119.e5546","type":"link in","z":"9735dbc5.e84748","name":"estudioIn","links":["ea09a05d.340fd","9f04a75e.a420d8","39adf3cd.33e6ec"],"x":1035,"y":580,"wires":[["8300d574.a628e8"]]},{"id":"38ae23f0.a0d50c","type":"link in","z":"9735dbc5.e84748","name":"calderaIn","links":["89dec6ae.9ff378","60bedacc.e1f874","6d8dd1cc.6a437"],"x":1035,"y":640,"wires":[["71df71f.0e1059"]]},{"id":"5b36a3f3.1e835c","type":"link out","z":"9735dbc5.e84748","name":"salonOut","links":["dab655a4.84c8e8"],"x":1115,"y":820,"wires":[]},{"id":"8e71f1df.c48b1","type":"link out","z":"9735dbc5.e84748","name":"habOut","links":["255434f7.f92abc"],"x":1135,"y":880,"wires":[]},{"id":"9f04a75e.a420d8","type":"link out","z":"9735dbc5.e84748","name":"estudioOut","links":["ea16b119.e5546"],"x":1135,"y":940,"wires":[]},{"id":"60bedacc.e1f874","type":"link out","z":"9735dbc5.e84748","name":"calderaOut","links":["38ae23f0.a0d50c"],"x":1135,"y":980,"wires":[]},{"id":"47b944d4.30c15c","type":"mqtt in","z":"9735dbc5.e84748","name":"","topic":"serverSwitch/caldera","qos":"1","datatype":"auto","broker":"353193e2.3064fc","x":90,"y":260,"wires":[["1261c411.f494fc"]]},{"id":"18dc394e.39f2c7","type":"function","z":"9735dbc5.e84748","name":"reset Caldera","func":"var msg1 ={};\nvar msg2 ={};\nvar msg3 ={};\nvar msg4 ={};\nvar lastState = flow.get('lastState');\n\nmsg1.payload = {\"canal\":1,\"status\":lastState.salon};\nmsg2.payload = {\"canal\":2,\"status\":lastState.hab};\nmsg3.payload = {\"canal\":3,\"status\":lastState.estudio};\nmsg4.payload = {\"canal\":4,\"status\":lastState.caldera};\nreturn [msg1,msg2,msg3,msg4];","outputs":4,"noerr":0,"x":960,"y":260,"wires":[["6e50d8c1.7e5538"],["b1cb8e9d.d0c38"],["39adf3cd.33e6ec"],["6d8dd1cc.6a437"]]},{"id":"6e50d8c1.7e5538","type":"link out","z":"9735dbc5.e84748","name":"salonReiniciadoOut","links":["dab655a4.84c8e8"],"x":1195,"y":220,"wires":[]},{"id":"b1cb8e9d.d0c38","type":"link out","z":"9735dbc5.e84748","name":"habReiniciadoOut","links":["255434f7.f92abc"],"x":1195,"y":260,"wires":[]},{"id":"39adf3cd.33e6ec","type":"link out","z":"9735dbc5.e84748","name":"estudioReiniciadoOut","links":["ea16b119.e5546"],"x":1195,"y":300,"wires":[]},{"id":"6d8dd1cc.6a437","type":"link out","z":"9735dbc5.e84748","name":"calderaReiniciadoOut","links":["38ae23f0.a0d50c"],"x":1195,"y":340,"wires":[]},{"id":"1261c411.f494fc","type":"delay","z":"9735dbc5.e84748","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":260,"y":260,"wires":[["a8168732.5f1f88"]]},{"id":"ca607d2e.d6f0d","type":"switch","z":"9735dbc5.e84748","name":"","property":"lastState","propertyType":"flow","rules":[{"t":"neq","v":"vacio","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":590,"y":260,"wires":[["18dc394e.39f2c7","545332b8.11510c"]]},{"id":"c3fec51e.c01cd8","type":"random","z":"9735dbc5.e84748","name":"","low":"21","high":"25","inte":"true","property":"payload","x":260,"y":580,"wires":[["804934b2.8e2ef8"]]},{"id":"a71d83b6.e81b8","type":"random","z":"9735dbc5.e84748","name":"","low":"21","high":"25","inte":"true","property":"payload","x":260,"y":640,"wires":[["8a83a85d.5af3a8"]]},{"id":"99bcafd3.5f957","type":"link in","z":"c88d6057.281f6","name":"inyecta","links":["6656ef43.04a05"],"x":155,"y":320,"wires":[["7142cbe3.8df544"]]},{"id":"a8168732.5f1f88","type":"switch","z":"9735dbc5.e84748","name":"","property":"DatosCalefaccion.OnOff","propertyType":"flow","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":430,"y":260,"wires":[["ca607d2e.d6f0d"]]},{"id":"1ec047a1.9a7208","type":"link in","z":"9735dbc5.e84748","name":"resetea contexto","links":["a4510945.59f468"],"x":595,"y":920,"wires":[["2eb0c9ef.eb8406"]]},{"id":"a4510945.59f468","type":"link out","z":"9735dbc5.e84748","name":"rst caldera","links":["1ec047a1.9a7208"],"x":875,"y":380,"wires":[]},{"id":"545332b8.11510c","type":"change","z":"9735dbc5.e84748","name":"reset","rules":[{"t":"set","p":"payload","pt":"msg","to":"reset","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":360,"wires":[["a4510945.59f468"]]},{"id":"c4dff291.9fcd7","type":"watch","z":"9735dbc5.e84748","name":"cambios en calefaccion","files":"resources/configuraciones/termostato.json","recursive":"","x":120,"y":160,"wires":[["d0845014.cd41d"]]},{"id":"d0845014.cd41d","type":"file in","z":"9735dbc5.e84748","name":"cargaConfig","filename":"resources/configuraciones/termostato.json","format":"utf8","chunk":false,"sendError":false,"x":310,"y":160,"wires":[["8cbf03a.17e55"]]},{"id":"8cbf03a.17e55","type":"json","z":"9735dbc5.e84748","name":"calefaccionJson","property":"payload","action":"obj","pretty":false,"x":480,"y":160,"wires":[["99a8ba4.a0f4c48"]]},{"id":"99a8ba4.a0f4c48","type":"change","z":"9735dbc5.e84748","name":"datos calefaccion","rules":[{"t":"set","p":"DatosCalefaccion","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":160,"wires":[["9742669e.26b6e8"]]},{"id":"ae14395e.dc7098","type":"debug","z":"9735dbc5.e84748","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1030,"y":100,"wires":[]},{"id":"9742669e.26b6e8","type":"switch","z":"9735dbc5.e84748","name":"","property":"DatosCalefaccion.OnOff","propertyType":"flow","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":850,"y":160,"wires":[["ae14395e.dc7098","2111ae0c.1a01a2","545332b8.11510c","1855822.e28577e","59720ff.365d3f","f29c7df5.d308a"]]},{"id":"af841e8b.71268","type":"comment","z":"9735dbc5.e84748","name":"resetea si cambia a off","info":"resetea todas las variables al cambiar de on a\noff","x":120,"y":120,"wires":[]},{"id":"dde15df2.ba224","type":"ui_led","z":"9735dbc5.e84748","group":"1e9b1326.5b8a7d","order":2,"label":"Salon","colorForValue":[{"color":"orange","value":"false","valueType":"bool"},{"color":"green","value":"true","valueType":"bool"},{"color":"grey","value":"none","valueType":"str"}],"name":"Salon","x":1830,"y":720,"wires":[]},{"id":"a0c82508.e54728","type":"ui_led","z":"9735dbc5.e84748","group":"1e9b1326.5b8a7d","order":3,"label":"Habitaciones","colorForValue":[{"color":"orange","value":"false","valueType":"bool"},{"color":"green","value":"true","valueType":"bool"},{"color":"grey","value":"none","valueType":"str"}],"name":"Habitaciones","x":1830,"y":900,"wires":[]},{"id":"e22d2778.e94208","type":"ui_led","z":"9735dbc5.e84748","group":"1e9b1326.5b8a7d","order":4,"label":"Estudio","colorForValue":[{"color":"orange","value":"false","valueType":"bool"},{"color":"green","value":"true","valueType":"bool"},{"color":"grey","value":"none","valueType":"str"}],"name":"Estudio","x":1860,"y":1000,"wires":[]},{"id":"d49b7d82.584c1","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"On","vt":"str"},{"t":"eq","v":"Off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1470,"y":740,"wires":[["90f4ec33.1d218"],["2cdb8a06.10c8d6"]]},{"id":"90f4ec33.1d218","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":720,"wires":[["dde15df2.ba224"]]},{"id":"2cdb8a06.10c8d6","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":760,"wires":[["dde15df2.ba224"]]},{"id":"ff8c65ab.03c958","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"On","vt":"str"},{"t":"eq","v":"Off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1490,"y":900,"wires":[["eefb3060.3c3b6"],["1855822.e28577e"]]},{"id":"eefb3060.3c3b6","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":880,"wires":[["a0c82508.e54728"]]},{"id":"1855822.e28577e","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":920,"wires":[["a0c82508.e54728"]]},{"id":"55805576.a714bc","type":"switch","z":"9735dbc5.e84748","name":"","property":"payload.status","propertyType":"msg","rules":[{"t":"eq","v":"On","vt":"str"},{"t":"eq","v":"Off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1490,"y":1020,"wires":[["2f0ab2f6.f020ae"],["59720ff.365d3f"]]},{"id":"2f0ab2f6.f020ae","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":1000,"wires":[["e22d2778.e94208"]]},{"id":"59720ff.365d3f","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":1040,"wires":[["e22d2778.e94208"]]},{"id":"f29c7df5.d308a","type":"change","z":"9735dbc5.e84748","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"none","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":160,"wires":[["dde15df2.ba224","a0c82508.e54728","e22d2778.e94208"]]},{"id":"aaedd20d.6419a","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"8","set":true,"level":"1","freq":"","out":"out","x":1800,"y":100,"wires":[]},{"id":"3f65661a.3b338a","type":"ui_button","z":"6749f74e.18d698","name":"Riego 2","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"2","payloadType":"num","topic":"","x":960,"y":700,"wires":[["2276863e.8c7d9a"]]},{"id":"5cf32311.ea941c","type":"ui_button","z":"6749f74e.18d698","name":"Riego 3","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"3","payloadType":"num","topic":"","x":960,"y":780,"wires":[["2276863e.8c7d9a"]]},{"id":"5064ea68.94d874","type":"ui_button","z":"6749f74e.18d698","name":"Riego 4","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"4","payloadType":"num","topic":"","x":960,"y":880,"wires":[["2276863e.8c7d9a"]]},{"id":"9ee34525.4a30c8","type":"ui_button","z":"6749f74e.18d698","name":"Riego 5","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"5","payloadType":"num","topic":"","x":960,"y":980,"wires":[["2276863e.8c7d9a"]]},{"id":"2276863e.8c7d9a","type":"function","z":"6749f74e.18d698","name":"conmuta botones","func":"var msgMatriz = [\n                    { payload : null },\n                    { payload : null },\n                    { payload : null },\n                    { payload : null },\n                    { payload : null },\n                    { payload : null },\n                    { payload : null },\n                    { payload : null }\n                  ]\n\n\nvar boton = msg.payload;\n\nvar botonAnterior = context.get('botonAnterior') || 0;\nvar estado = context.get('Estado');\n\nif(botonAnterior === 0){\n    \n    botonAnterior = boton;\n    context.set('botonAnterior', botonAnterior);\n    estado = false;\n    context.set('Estado', estado);\n    msgMatriz[boton-1] = {payload : estado};\n    return [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];\n}\n\n\nif(botonAnterior===boton){\n    \n    if(estado===false){\n        estado = true;\n        context.set('Estado', estado);\n        msgMatriz[boton-1] = {payload : estado};\n        return [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];\n    }\n    else{\n        estado = false;\n        context.set('Estado', estado);\n        msgMatriz[boton-1] = {payload : estado};\n        return [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];\n    }\n      \n}\n\nif(botonAnterior!==boton){\n    \n        estado = false;\n        context.set('Estado', estado);\n        botonAnterior = boton;\n        context.set('botonAnterior', botonAnterior);\n        msgMatriz[boton-1] = {payload : estado};\n        return [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];\n    \n}\n\nreturn [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];\n","outputs":8,"noerr":0,"x":1190,"y":820,"wires":[["1e0583ba.9499ec"],["e476a0e9.43cc"],["266ac1ab.922bce"],["12355d32.66a8c3"],["530ccf2e.341f4"],["a97a2dd7.a199d"],["8715c87.e8f5d38"],["fb2bcb6b.a74c68"]]},{"id":"1e0583ba.9499ec","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":120,"wires":[["aaedd20d.6419a","b259cac2.4f0b78"],["2eac42e6.ebb43e","36a57917.babd66"]]},{"id":"2eac42e6.ebb43e","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":180,"wires":[["aaedd20d.6419a"]]},{"id":"30fda314.1a3a2c","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"10","set":true,"level":"1","freq":"","out":"out","x":1780,"y":320,"wires":[]},{"id":"e476a0e9.43cc","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":340,"wires":[["30fda314.1a3a2c","459b7b68.87c414"],["9d882692.6915f8","82337f29.99376"]]},{"id":"9d882692.6915f8","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":400,"wires":[["30fda314.1a3a2c"]]},{"id":"8008252c.50dce8","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"12","set":true,"level":"1","freq":"","out":"out","x":1820,"y":540,"wires":[]},{"id":"266ac1ab.922bce","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1570,"y":560,"wires":[["8008252c.50dce8","d73393d1.ea936"],["b6c33821.8c5bf8","5ea9c1c9.0d113"]]},{"id":"b6c33821.8c5bf8","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1700,"y":620,"wires":[["8008252c.50dce8"]]},{"id":"2e4e3715.db1bb8","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"16","set":true,"level":"1","freq":"","out":"out","x":1820,"y":780,"wires":[]},{"id":"12355d32.66a8c3","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1570,"y":800,"wires":[["2e4e3715.db1bb8","13e6b0ab.be6aaf"],["bde00303.790e3","7817134.d9aa3ec"]]},{"id":"bde00303.790e3","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1700,"y":860,"wires":[["2e4e3715.db1bb8"]]},{"id":"da5280ad.45a85","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"18","set":true,"level":"1","freq":"","out":"out","x":1800,"y":1000,"wires":[]},{"id":"530ccf2e.341f4","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":1020,"wires":[["da5280ad.45a85","77cbc95f.6a52d8"],["3ebdf770.893aa8","49826c45.ec3b34"]]},{"id":"3ebdf770.893aa8","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":1080,"wires":[["da5280ad.45a85"]]},{"id":"e6e35b7c.f57388","type":"change","z":"6749f74e.18d698","name":"nombres","rules":[{"t":"set","p":"nombresCanal","pt":"flow","to":"{\"boton1\":\"canal 1\",\"boton2\":\"canal 2\",\"boton3\":\"canal 3\",\"boton4\":\"canal 4\",\"boton5\":\"canal 5\",\"boton6\":\"canal 6\",\"boton7\":\"canal 7\",\"boton8\":\"Piscina\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":780,"wires":[["f87105bc.ef9258","46947f4c.cb7dc","3df9102.796acf","5a933a48.b43474","b74939df.819148","6ed4bd78.6fd5e4","7a5c8b99.834a64","df29782.680a988"]]},{"id":"f87105bc.ef9258","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton1","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":620,"wires":[["e43b408a.c3e01"]]},{"id":"3a39f0c.487711","type":"inject","z":"6749f74e.18d698","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":780,"wires":[["e6e35b7c.f57388"]]},{"id":"46947f4c.cb7dc","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton2","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":700,"wires":[["3f65661a.3b338a"]]},{"id":"3df9102.796acf","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton3","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":780,"wires":[["5cf32311.ea941c"]]},{"id":"5a933a48.b43474","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton4","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":880,"wires":[["5064ea68.94d874"]]},{"id":"b74939df.819148","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton5","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":980,"wires":[["9ee34525.4a30c8"]]},{"id":"8840ccb5.2df3","type":"function","z":"f25737d2.a56978","name":"activa canal","func":"var mensaje = msg.payload\nvar valor = null;\nvar msgMatriz = [\n        {payload : null},\n        {payload : null},\n        {payload : null},\n        {payload : null},\n        {payload : null},\n        {payload : null},\n        {payload : null},\n        {payload : null}\n    ]\n\nif(mensaje.status === \"off\") valor = 1;\nelse if(mensaje.status === \"on\") valor = 0;\n\nmsgMatriz[mensaje.canal] = {payload : valor};\n\nreturn [msgMatriz[0],msgMatriz[1],msgMatriz[2],msgMatriz[3],msgMatriz[4],msgMatriz[5],msgMatriz[6],msgMatriz[7]];","outputs":8,"noerr":0,"x":1170,"y":700,"wires":[["4bfbef26.b33b1"],["7fa8c47.025993c"],["1af8a242.ca021e"],["cbb403ad.a0925"],["71ae0942.53d268"],["e5f4a984.bb9088"],["fddeae5f.330ee"],["9ee76f6b.c471b"]]},{"id":"eaffc42e.015908","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"8","set":true,"level":"1","freq":"","out":"out","x":1520,"y":580,"wires":[]},{"id":"1e1ce851.9b7268","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"10","set":true,"level":"1","freq":"","out":"out","x":1520,"y":640,"wires":[]},{"id":"f8556219.7412c","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"12","set":true,"level":"1","freq":"","out":"out","x":1520,"y":700,"wires":[]},{"id":"d4eeb265.79a7b","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"16","set":true,"level":"1","freq":"","out":"out","x":1520,"y":760,"wires":[]},{"id":"deaaa43.94edf58","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"18","set":true,"level":"1","freq":"","out":"out","x":1520,"y":820,"wires":[]},{"id":"4bfbef26.b33b1","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":580,"wires":[["eaffc42e.015908"]]},{"id":"7fa8c47.025993c","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":640,"wires":[["1e1ce851.9b7268"]]},{"id":"1af8a242.ca021e","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":700,"wires":[["f8556219.7412c"]]},{"id":"cbb403ad.a0925","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":760,"wires":[["d4eeb265.79a7b"]]},{"id":"71ae0942.53d268","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":820,"wires":[["deaaa43.94edf58"]]},{"id":"17f5f3b0.d8ceec","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2270,"y":280,"wires":[["83010e5.b15abf"]]},{"id":"a7f40697.7569a8","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":340,"wires":[["17f5f3b0.d8ceec"],["a4bce0af.01332"],["a4bce0af.01332"]]},{"id":"a4bce0af.01332","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":360,"wires":[["83010e5.b15abf"]]},{"id":"3632fd9c.3a87a2","type":"link in","z":"6749f74e.18d698","name":"colorBoton1","links":["36a57917.babd66","b259cac2.4f0b78"],"x":1995,"y":340,"wires":[["a7f40697.7569a8"]]},{"id":"b259cac2.4f0b78","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut1","links":["3632fd9c.3a87a2"],"x":1715,"y":20,"wires":[]},{"id":"36a57917.babd66","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut1","links":["3632fd9c.3a87a2"],"x":1715,"y":60,"wires":[]},{"id":"83010e5.b15abf","type":"link out","z":"6749f74e.18d698","name":"colorSalida1","links":["b94468f7.986ae8"],"x":2395,"y":340,"wires":[]},{"id":"b94468f7.986ae8","type":"link in","z":"6749f74e.18d698","name":"colorCanal1","links":["83010e5.b15abf"],"x":415,"y":620,"wires":[["f87105bc.ef9258"]]},{"id":"915dace7.d0d5c","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":460,"wires":[["5325ba74.e39f94"]]},{"id":"93d1535b.4d355","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":500,"wires":[["915dace7.d0d5c"],["cc66f99e.07a788"],["cc66f99e.07a788"]]},{"id":"cc66f99e.07a788","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":520,"wires":[["5325ba74.e39f94"]]},{"id":"a55815f6.39c998","type":"link in","z":"6749f74e.18d698","name":"colorBoton2","links":["459b7b68.87c414","82337f29.99376"],"x":1995,"y":500,"wires":[["93d1535b.4d355"]]},{"id":"5325ba74.e39f94","type":"link out","z":"6749f74e.18d698","name":"colorSalida2","links":["f959fc7d.e9dd8"],"x":2395,"y":500,"wires":[]},{"id":"459b7b68.87c414","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut2 ","links":["a55815f6.39c998"],"x":1695,"y":240,"wires":[]},{"id":"82337f29.99376","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut2","links":["a55815f6.39c998"],"x":1695,"y":280,"wires":[]},{"id":"f959fc7d.e9dd8","type":"link in","z":"6749f74e.18d698","name":"color canal","links":["5325ba74.e39f94"],"x":415,"y":680,"wires":[["46947f4c.cb7dc"]]},{"id":"d73393d1.ea936","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut3","links":["954d203a.1920d"],"x":1695,"y":460,"wires":[]},{"id":"5ea9c1c9.0d113","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut3","links":["954d203a.1920d"],"x":1695,"y":500,"wires":[]},{"id":"954d203a.1920d","type":"link in","z":"6749f74e.18d698","name":"colorBoton3","links":["5ea9c1c9.0d113","d73393d1.ea936"],"x":1995,"y":660,"wires":[["c359c211.b732a"]]},{"id":"c359c211.b732a","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":660,"wires":[["d476c504.efa158"],["e8d83400.05a66"],["e8d83400.05a66"]]},{"id":"d476c504.efa158","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":620,"wires":[["2a54b82e.ca4cb8"]]},{"id":"e8d83400.05a66","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":680,"wires":[["2a54b82e.ca4cb8"]]},{"id":"2a54b82e.ca4cb8","type":"link out","z":"6749f74e.18d698","name":"colorSalida3","links":["29d2f5d7.926b9a"],"x":2395,"y":660,"wires":[]},{"id":"29d2f5d7.926b9a","type":"link in","z":"6749f74e.18d698","name":"colorCanal3","links":["2a54b82e.ca4cb8"],"x":395,"y":860,"wires":[["3df9102.796acf"]]},{"id":"3ce70527.981c2a","type":"link in","z":"6749f74e.18d698","name":"colorBoton4","links":["13e6b0ab.be6aaf","7817134.d9aa3ec"],"x":1995,"y":820,"wires":[["6cb8f062.6d30b"]]},{"id":"6cb8f062.6d30b","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":820,"wires":[["32af6ac6.aebff6"],["fb1fb34a.14ee2"],["fb1fb34a.14ee2"]]},{"id":"32af6ac6.aebff6","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":780,"wires":[["cb18a005.85223"]]},{"id":"fb1fb34a.14ee2","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":840,"wires":[["cb18a005.85223"]]},{"id":"cb18a005.85223","type":"link out","z":"6749f74e.18d698","name":"colorSalida4","links":["8d971b7b.9288e8"],"x":2395,"y":820,"wires":[]},{"id":"8d971b7b.9288e8","type":"link in","z":"6749f74e.18d698","name":"colorCanal4","links":["cb18a005.85223"],"x":395,"y":920,"wires":[["5a933a48.b43474"]]},{"id":"13e6b0ab.be6aaf","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut4","links":["3ce70527.981c2a"],"x":1695,"y":680,"wires":[]},{"id":"7817134.d9aa3ec","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut4","links":["3ce70527.981c2a"],"x":1695,"y":720,"wires":[]},{"id":"4e0cdb59.3b85a4","type":"link in","z":"6749f74e.18d698","name":"colorBoton5","links":["49826c45.ec3b34","77cbc95f.6a52d8"],"x":1995,"y":980,"wires":[["795658a1.9d5f18"]]},{"id":"795658a1.9d5f18","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":980,"wires":[["360c1203.77087e"],["f6a3bf73.fd012"],["f6a3bf73.fd012"]]},{"id":"360c1203.77087e","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":940,"wires":[["c469e409.c7e838"]]},{"id":"f6a3bf73.fd012","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1000,"wires":[["c469e409.c7e838"]]},{"id":"c469e409.c7e838","type":"link out","z":"6749f74e.18d698","name":"colorSalida5","links":["1cd34e5d.154592"],"x":2395,"y":980,"wires":[]},{"id":"1cd34e5d.154592","type":"link in","z":"6749f74e.18d698","name":"colorCanal5","links":["c469e409.c7e838"],"x":395,"y":980,"wires":[["b74939df.819148"]]},{"id":"77cbc95f.6a52d8","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut5","links":["4e0cdb59.3b85a4"],"x":1695,"y":920,"wires":[]},{"id":"49826c45.ec3b34","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut5","links":["4e0cdb59.3b85a4"],"x":1695,"y":960,"wires":[]},{"id":"34fc0c4e.04a1c4","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"22","set":true,"level":"1","freq":"","out":"out","x":1800,"y":1220,"wires":[]},{"id":"a97a2dd7.a199d","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":1240,"wires":[["34fc0c4e.04a1c4","b37ae07e.62bc"],["eec9f2e6.b0713","48f97d32.21aa34"]]},{"id":"eec9f2e6.b0713","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":1300,"wires":[["34fc0c4e.04a1c4"]]},{"id":"b8aae1fe.798f7","type":"link in","z":"6749f74e.18d698","name":"colorBoton6","links":["48f97d32.21aa34","b37ae07e.62bc"],"x":1995,"y":1200,"wires":[["f56de546.284c98"]]},{"id":"f56de546.284c98","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":1200,"wires":[["c03b471c.388fa8"],["ef4719b4.33fbc8"],["ef4719b4.33fbc8"]]},{"id":"c03b471c.388fa8","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":1160,"wires":[["6336a499.32a4bc"]]},{"id":"ef4719b4.33fbc8","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1220,"wires":[["6336a499.32a4bc"]]},{"id":"6336a499.32a4bc","type":"link out","z":"6749f74e.18d698","name":"colorSalida6","links":["a74422b9.e8402"],"x":2395,"y":1200,"wires":[]},{"id":"b37ae07e.62bc","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut6","links":["b8aae1fe.798f7"],"x":1695,"y":1140,"wires":[]},{"id":"48f97d32.21aa34","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut6","links":["b8aae1fe.798f7"],"x":1695,"y":1180,"wires":[]},{"id":"a74422b9.e8402","type":"link in","z":"6749f74e.18d698","name":"colorCanal6","links":["6336a499.32a4bc"],"x":395,"y":1040,"wires":[["6ed4bd78.6fd5e4"]]},{"id":"6ed4bd78.6fd5e4","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton6","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1060,"wires":[["f6138d19.48758"]]},{"id":"f6138d19.48758","type":"ui_button","z":"6749f74e.18d698","name":"Riego 6","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"6","payloadType":"num","topic":"","x":960,"y":1060,"wires":[["2276863e.8c7d9a"]]},{"id":"98dc1e1e.b8e33","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"24","set":true,"level":"1","freq":"","out":"out","x":1800,"y":1460,"wires":[]},{"id":"8715c87.e8f5d38","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":1480,"wires":[["98dc1e1e.b8e33","f085c1f3.a2ea5"],["a1ed3e62.de7c1","d9596967.a9c858"]]},{"id":"a1ed3e62.de7c1","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":1540,"wires":[["98dc1e1e.b8e33"]]},{"id":"94b3967a.ca8d58","type":"link in","z":"6749f74e.18d698","name":"colorBoton7","links":["d9596967.a9c858","f085c1f3.a2ea5"],"x":1995,"y":1440,"wires":[["25857022.91fff"]]},{"id":"25857022.91fff","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":1440,"wires":[["88b08073.83ccf"],["9351707d.365bb"],["9351707d.365bb"]]},{"id":"88b08073.83ccf","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":1400,"wires":[["9a1d0d04.5fc4a"]]},{"id":"9351707d.365bb","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1460,"wires":[["9a1d0d04.5fc4a"]]},{"id":"9a1d0d04.5fc4a","type":"link out","z":"6749f74e.18d698","name":"colorSalida7","links":["6f7b6a8d.e03214"],"x":2395,"y":1440,"wires":[]},{"id":"f085c1f3.a2ea5","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut7","links":["94b3967a.ca8d58"],"x":1695,"y":1380,"wires":[]},{"id":"d9596967.a9c858","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut7","links":["94b3967a.ca8d58"],"x":1695,"y":1420,"wires":[]},{"id":"6f7b6a8d.e03214","type":"link in","z":"6749f74e.18d698","name":"colorCanal7","links":["9a1d0d04.5fc4a"],"x":395,"y":1100,"wires":[["7a5c8b99.834a64"]]},{"id":"7a5c8b99.834a64","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton7","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1140,"wires":[["a616d966.bc4f18"]]},{"id":"a616d966.bc4f18","type":"ui_button","z":"6749f74e.18d698","name":"Riego 7","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"7","payloadType":"num","topic":"","x":960,"y":1140,"wires":[["2276863e.8c7d9a"]]},{"id":"31e738a6.7d3788","type":"rpi-gpio out","z":"6749f74e.18d698","name":"","pin":"26","set":true,"level":"1","freq":"","out":"out","x":1800,"y":1720,"wires":[]},{"id":"fb2bcb6b.a74c68","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":1550,"y":1740,"wires":[["31e738a6.7d3788","a2ecdb45.549e68"],["5b287924.6eb6e8","63236b4d.241ef4"]]},{"id":"5b287924.6eb6e8","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1680,"y":1800,"wires":[["31e738a6.7d3788"]]},{"id":"20782901.d71e86","type":"link in","z":"6749f74e.18d698","name":"colorBoton8","links":["63236b4d.241ef4","a2ecdb45.549e68"],"x":1995,"y":1700,"wires":[["3d752c8d.0d0ce4"]]},{"id":"3d752c8d.0d0ce4","type":"switch","z":"6749f74e.18d698","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"true"},{"t":"null"}],"checkall":"true","repair":false,"outputs":3,"x":2090,"y":1700,"wires":[["d3bd659d.8d1fc8"],["671b6d14.3f8b34"],["671b6d14.3f8b34"]]},{"id":"d3bd659d.8d1fc8","type":"change","z":"6749f74e.18d698","name":"encendido","rules":[{"t":"set","p":"background","pt":"msg","to":"#043336","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":1660,"wires":[["678c73a6.ecb64c"]]},{"id":"671b6d14.3f8b34","type":"change","z":"6749f74e.18d698","name":"apagado","rules":[{"t":"set","p":"background","pt":"msg","to":"#097479","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"blanco","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1720,"wires":[["678c73a6.ecb64c"]]},{"id":"678c73a6.ecb64c","type":"link out","z":"6749f74e.18d698","name":"colorSalida8","links":["ae6b64df.9afce8"],"x":2395,"y":1700,"wires":[]},{"id":"a2ecdb45.549e68","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut8","links":["20782901.d71e86"],"x":1695,"y":1640,"wires":[]},{"id":"63236b4d.241ef4","type":"link out","z":"6749f74e.18d698","name":"colorBotonOut8","links":["20782901.d71e86"],"x":1695,"y":1680,"wires":[]},{"id":"ae6b64df.9afce8","type":"link in","z":"6749f74e.18d698","name":"colorCanal8","links":["678c73a6.ecb64c"],"x":395,"y":1180,"wires":[["df29782.680a988"]]},{"id":"df29782.680a988","type":"change","z":"6749f74e.18d698","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"nombresCanal.boton8","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1220,"wires":[["fbef1eb0.f1892"]]},{"id":"fbef1eb0.f1892","type":"ui_button","z":"6749f74e.18d698","name":"Riego 8","group":"f8c613ca.ef745","order":0,"width":"4","height":"2","passthru":false,"label":"{{msg.topic}}","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"8","payloadType":"num","topic":"","x":960,"y":1220,"wires":[["2276863e.8c7d9a"]]},{"id":"cd12f781.0799a8","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"22","set":true,"level":"1","freq":"","out":"out","x":1520,"y":900,"wires":[]},{"id":"e5f4a984.bb9088","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":900,"wires":[["cd12f781.0799a8"]]},{"id":"37b2183f.70f2c8","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"24","set":true,"level":"1","freq":"","out":"out","x":1520,"y":960,"wires":[]},{"id":"fddeae5f.330ee","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":960,"wires":[["37b2183f.70f2c8"]]},{"id":"d6887839.f2ce28","type":"rpi-gpio out","z":"f25737d2.a56978","name":"","pin":"26","set":true,"level":"1","freq":"","out":"out","x":1520,"y":1020,"wires":[]},{"id":"9ee76f6b.c471b","type":"switch","z":"f25737d2.a56978","name":"No null","property":"payload","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1360,"y":1020,"wires":[["d6887839.f2ce28"]]},{"id":"29bf7d8a.cb0262","type":"inject","z":"6749f74e.18d698","name":"","topic":"","payload":"","payloadType":"date","repeat":"3","crontab":"","once":true,"onceDelay":0.1,"x":210,"y":340,"wires":[["5a4cdf1d.dda88"]]},{"id":"5a4cdf1d.dda88","type":"function","z":"6749f74e.18d698","name":"botones Enabled","func":"var actividad = global.get('actividadRiego');\nvar unavez = context.get('unaVez') || false;\nif(actividad){\n    msg.enabled = false;\n    unavez = true;\n    context.set('unaVez', unavez);\n    return msg;\n}\nelse if(actividad === false && unavez === true){\n    msg.enabled = true;\n    unavez = false;\n    context.set('unaVez', unavez);\n    return msg;\n}\nreturn;","outputs":1,"noerr":0,"x":430,"y":340,"wires":[["f87105bc.ef9258","46947f4c.cb7dc","3df9102.796acf","5a933a48.b43474","b74939df.819148","6ed4bd78.6fd5e4","7a5c8b99.834a64","df29782.680a988"]]},{"id":"54b3894c.144348","type":"change","z":"f25737d2.a56978","name":"Flag Activo","rules":[{"t":"set","p":"actividadRiego","pt":"global","to":"Activo","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":260,"wires":[[]]},{"id":"1328a6ed.c26349","type":"rpi-gpio out","z":"9735dbc5.e84748","name":"","pin":"32","set":true,"level":"1","freq":"","out":"out","x":1360,"y":640,"wires":[]},{"id":"5377cf3c.6ab18","type":"rpi-gpio out","z":"9735dbc5.e84748","name":"","pin":"36","set":true,"level":"1","freq":"","out":"out","x":1360,"y":580,"wires":[]},{"id":"8300d574.a628e8","type":"function","z":"9735dbc5.e84748","name":"","func":"var valor = msg.payload.status;\nif(valor === \"On\") msg.payload = 0;\nelse if(valor === \"Off\") msg.payload = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1150,"y":580,"wires":[["5377cf3c.6ab18"]]},{"id":"71df71f.0e1059","type":"function","z":"9735dbc5.e84748","name":"","func":"var valor = msg.payload.status;\nif(valor === \"On\") msg.payload = 0;\nelse if(valor === \"Off\") msg.payload = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1150,"y":640,"wires":[["1328a6ed.c26349"]]},{"id":"162e1273.c462de","type":"rpi-gpio out","z":"9735dbc5.e84748","name":"","pin":"38","set":true,"level":"1","freq":"","out":"out","x":1360,"y":520,"wires":[]},{"id":"9838d46e.cc6fc8","type":"function","z":"9735dbc5.e84748","name":"","func":"var valor = msg.payload.status;\nif(valor === \"On\") msg.payload = 0;\nelse if(valor === \"Off\") msg.payload = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1150,"y":520,"wires":[["162e1273.c462de"]]},{"id":"793f4bee.da5664","type":"rpi-gpio out","z":"9735dbc5.e84748","name":"","pin":"40","set":true,"level":"1","freq":"","out":"out","x":1360,"y":460,"wires":[]},{"id":"27a59f8e.1d3b8","type":"function","z":"9735dbc5.e84748","name":"","func":"var valor = msg.payload.status;\nif(valor === \"On\") msg.payload = 0;\nelse if(valor === \"Off\") msg.payload = 1;\nreturn msg;","outputs":1,"noerr":0,"x":1150,"y":460,"wires":[["793f4bee.da5664"]]}]